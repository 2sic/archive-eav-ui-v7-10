!function(){angular.module("ContentExportApp",["EavAdminUi","EavDirectives","EavConfiguration","EavServices","ContentHelperFilters","ContentFormlyTypes"])}(),function(){function t(t,e,n,a,i,r,o,l,s){var d=this;d.formValues={},d.formFields=[{key:"AppId",type:"hidden",defaultValue:t},{key:"DefaultLanguage",type:"hidden",defaultValue:l("isoLangCode")(r.defaultLanguage)},{key:"ContentType",type:"hidden",defaultValue:e},{key:"Language",type:"select",expressionProperties:{"templateOptions.label":"'Content.Export.Fields.Language.Label' | translate","templateOptions.options":function(){var t=[{name:s.instant("Content.Export.Fields.Language.Options.All"),value:""}];return angular.forEach(r.languages,function(e){var n=l("isoLangCode")(e.key);t.push({name:n,value:n})}),t}},defaultValue:""},{key:"RecordExport",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Export.Fields.RecordExport.Label' | translate","templateOptions.options":function(){return[{name:s.instant("Content.Export.Fields.RecordExport.Options.Blank"),value:"Blank"},{name:s.instant("Content.Export.Fields.RecordExport.Options.All"),value:"All"}]}},defaultValue:"All"},{key:"LanguageReferences",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Export.Fields.LanguageReferences.Label' | translate","templateOptions.disabled":function(){return"Blank"==d.formValues.RecordExport},"templateOptions.options":function(){return[{name:s.instant("Content.Export.Fields.LanguageReferences.Options.Link"),value:"Link"},{name:s.instant("Content.Export.Fields.LanguageReferences.Options.Resolve"),value:"Resolve"}]}},defaultValue:"Link"},{key:"ResourcesReferences",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Export.Fields.ResourcesReferences.Label' | translate","templateOptions.disabled":function(){return"Blank"==d.formValues.RecordExport},"templateOptions.options":function(){return[{name:s.instant("Content.Export.Fields.ResourcesReferences.Options.Link"),value:"Link"},{name:s.instant("Content.Export.Fields.ResourcesReferences.Options.Resolve"),value:"Resolve"}]}},defaultValue:"Link"}],d.exportContent=function(){n.exportContent(d.formValues)},d.close=function(){o.dismiss("cancel")}}t.$inject=["appId","contentType","contentExportService","eavAdminDialogs","eavConfig","languages","$modalInstance","$filter","$translate"],angular.module("ContentExportApp").controller("ContentExport",t)}(),function(){function t(t,e){function n(t){var n=e.getUrlPrefix("api")+"/eav/ContentExport/ExportContent";window.open(n+"?appId="+t.AppId+"&language="+t.Language+"&defaultLanguage="+t.DefaultLanguage+"&contentType="+t.ContentType+"&recordExport="+t.RecordExport+"&resourcesReferences="+t.ResourcesReferences+"&languageReferences="+t.LanguageReferences,"_self","")}var a={exportContent:n};return a}t.$inject=["$http","eavConfig"],angular.module("ContentExportApp").factory("contentExportService",t)}(),function(){angular.module("ContentFormlyTypes",["naif.base64","formly","formlyBootstrap","ui.bootstrap"])}(),function(){angular.module("ContentFormlyTypes").config(["formlyConfigProvider",function(t){var e=t;e.setType({name:"file",template:"<span class='btn btn-default btn-square btn-file'><span class='glyphicon glyphicon-open'></span><input type='file' ng-model='model[options.key]' base-sixty-four-input /></span> <span ng-if='model[options.key]'>{{model[options.key].filename}}</span>",wrapper:["bootstrapLabel","bootstrapHasError"]}),e.setType({name:"hidden",template:"<input style='display:none' ng-model='model[options.key]' />",wrapper:["bootstrapLabel","bootstrapHasError"]})}])}(),function(){angular.module("ContentHelperFilters",[]),angular.module("ContentHelperFilters").filter("isoLangCode",function(){return function(t){return 5!=t.length?t:t.substring(0,2).toLowerCase()+"-"+t.substring(3,5).toUpperCase()}})}(),function(){angular.module("ContentImportApp",["EavAdminUi","EavDirectives","EavConfiguration","EavServices","ContentHelperFilters","ContentFormlyTypes"])}(),function(){function t(t,e,n,a,i,r,o,l,s,d){var c=this;c.debug=o,c.formValues={},c.formFields=[{key:"AppId",type:"hidden",defaultValue:t},{key:"DefaultLanguage",type:"hidden",defaultValue:s("isoLangCode")(r.defaultLanguage)},{key:"ContentType",type:"hidden",defaultValue:e},{key:"File",type:"file",templateOptions:{required:!0},expressionProperties:{"templateOptions.label":"'Content.Import.Fields.File.Label' | translate"}},{key:"ResourcesReferences",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Import.Fields.ResourcesReferences.Label' | translate","templateOptions.options":function(){return[{name:d.instant("Content.Import.Fields.ResourcesReferences.Options.Keep"),value:"Keep"},{name:d.instant("Content.Import.Fields.ResourcesReferences.Options.Resolve"),value:"Resolve"}]}},defaultValue:"Keep"},{key:"ClearEntities",type:"radio",expressionProperties:{"templateOptions.label":"'Content.Import.Fields.ClearEntities.Label' | translate","templateOptions.options":function(){return[{name:d.instant("Content.Import.Fields.ClearEntities.Options.None"),value:"None"},{name:d.instant("Content.Import.Fields.ClearEntities.Options.All"),value:"All"}]}},defaultValue:"None"}],c.viewStates={Waiting:0,Default:1,Evaluated:2,Imported:3},c.viewStateSelected=c.viewStates.Default,c.evaluationResult={},c.importResult={},c.evaluateContent=function(){return c.viewStateSelected=c.viewStates.Waiting,n.evaluateContent(c.formValues).then(function(t){c.evaluationResult=t.data,c.viewStateSelected=c.viewStates.Evaluated})},c.importContent=function(){return c.viewStateSelected=c.viewStates.Waiting,n.importContent(c.formValues).then(function(t){c.importResult=t.data,c.viewStateSelected=c.viewStates.Imported})},c.reset=function(){c.formValues={},c.evaluationResult={},c.importResult={}},c.back=function(){c.viewStateSelected=c.viewStates.Default},c.close=function(){c.viewStateSelected=c.viewStates.Default,l.dismiss("cancel")}}t.$inject=["appId","contentType","contentImportService","eavAdminDialogs","eavConfig","languages","debugState","$modalInstance","$filter","$translate"],angular.module("ContentImportApp").controller("ContentImport",t)}(),function(){function t(t){function e(e){return t.post("eav/ContentImport/EvaluateContent",{AppId:e.AppId,DefaultLanguage:e.DefaultLanguage,ContentType:e.ContentType,ContentBase64:e.File.base64,ResourcesReferences:e.ResourcesReferences,ClearEntities:e.ClearEntities})}function n(e){return t.post("eav/ContentImport/ImportContent",{AppId:e.AppId,DefaultLanguage:e.DefaultLanguage,ContentType:e.ContentType,ContentBase64:e.File.base64,ResourcesReferences:e.ResourcesReferences,ClearEntities:e.ClearEntities})}var a={evaluateContent:e,importContent:n};return a}t.$inject=["$http"],angular.module("ContentImportApp").factory("contentImportService",t)}(),function(){function t(t,e,n,a,i){var r=this;r.mode=t,r.entityId=e,r.contentType=n,r.TestMessage="Test message the controller is binding correctly...",r.history=function(){return a.openItemHistory(r.entityId)},r.close=function(){i.dismiss("cancel")}}t.$inject=["mode","entityId","contentType","eavAdminDialogs","$modalInstance"],angular.module("ContentEditApp",["EavServices","EavAdminUi"]).controller("EditContentItem",t)}(),function(){"use strict";function t(t,e,n,a,i,r,o,l,s,d,c){function p(){k=t(n,a),s.all([g(),k.getColumns()]).then(function(t){var e=f(t[1].data);A.gridOptions.api.setColumnDefs(e);var n=A.gridOptions.api.gridPanel.eBodyContainer.clientWidth,a=A.gridOptions.api.gridPanel.eBodyViewport.clientWidth;a>n&&u(n)})}function u(t){var e=d.getTop().value.modalDomEl,n=e.children();n.css("width",t+47+"px")}function m(){i.openItemNew(a,g)}function v(t){i.openItemEditWithEntityId(t.data.Id,g)}function g(){var t={},e={};return A.gridOptions.api&&(t=A.gridOptions.api.getSortModel(),e=A.gridOptions.api.getFilterModel()),k.liveListSourceRead().then(function(n){A.gridOptions.api.setRowData(n.data),A.gridOptions.api.setSortModel(t),A.gridOptions.api.setFilterModel(e)})}function f(t){var e=x;return angular.forEach(t,function(t){if(t.IsTitle)return void(x[2].eavAttribute=t);var n={eavAttribute:t,headerName:t.StaticName,field:t.StaticName,cellRenderer:T,filterParams:{cellRenderer:S}};switch(t.Type){case"Entity":try{n.allowMultiValue=t.Metadata.Entity.AllowMultiValue}catch(a){n.allowMultiValue=!0}n.cellRenderer=C,n.valueGetter=b;break;case"DateTime":try{n.useTimePicker=t.Metadata.DateTime.UseTimePicker}catch(a){n.useTimePicker=!1}n.valueGetter=h;break;case"Boolean":n.valueGetter=I;break;case"Number":n.filter="number"}e.push(n)}),e}function b(t){var e=t.data[t.colDef.field];return 0===e.length?null:e.map(function(t){return t.Title})}function y(t){return[t.data.IsPublished?"is published":"is not published",t.data.Metadata?"is metadata":"is not metadata"]}function h(t){var e=t.data[t.colDef.field];return e?t.colDef.useTimePicker?e.substr(0,19).replace("T"," "):e.substr(0,10):null}function I(t){var e=t.data[t.colDef.field];return"boolean"!=typeof e?null:e.toString()}function T(t){if("string"!=typeof t.value||null===t.value)return t.value;var e=E(t.value);return'<span title="'+e+'">'+e+"</span>"}function S(t){return T(t)||"(empty)"}function E(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function C(t){if(!Array.isArray(t.value))return null;var e=E(t.value.join(", ")),n='<span title="'+e+'">';return t.colDef.allowMultiValue&&(n+='<span class="badge badge-primary">'+t.value.length+"</span> "),n+=e+"</span>"}function D(t){var e=c.instant("General.Questions.DeleteEntity",{title:t.Title,id:t.RepositoryId});confirm(e)&&k["delete"](t.RepositoryId,!1).then(function(e){if(e.status>=200&&e.status<300)return void g();var n="<div>"+c.instant("General.Questions.ForceDelete",{title:t.Title,id:t.RepositoryId})+"<br/><button type='button' id='del' class='btn btn-default' ><i class= 'icon-ok'></i>"+c.instant("General.Buttons.ForceDelete")+"</button></div>";r.warning(n,{allowHtml:!0,timeOut:5e3,onShown:function(e){e.el[0].onclick=function(e){var n=e.target||e.srcElement;"del"===n.id&&k["delete"](t.RepositoryId,!0).then(g)}}})})}function w(t){var e=[{ContentTypeName:a,DuplicateEntity:t.Id}];i.openEditItems(e,k.liveListReload)}function P(){l.dismiss("cancel")}var k,A=angular.extend(this,{debug:o,gridOptions:{enableSorting:!0,enableFilter:!0,rowHeight:39,colWidth:155,headerHeight:38,angularCompileRows:!0},add:m,refresh:g,tryToDelete:D,openDuplicate:w,close:P}),x=[{headerName:"ID",field:"Id",width:50,template:'<span tooltip-append-to-body="true" tooltip="Id: {{data.Id}}\nRepoId: {{data.RepositoryId}}\nGuid: {{data.Guid}}" ng-bind="data.Id"></span>',cellClass:"clickable",filter:"number",onCellClicked:v},{headerName:"Status",field:"IsPublished",width:75,suppressSorting:!0,template:"<span class=\"glyphicon\" ng-class=\"{'glyphicon-eye-open': data.IsPublished, 'glyphicon-eye-close' : !data.IsPublished}\" tooltip-append-to-body=\"true\" tooltip=\"{{ 'Content.Publish.' + (data.IsPublished ? 'PnV': data.Published ? 'DoP' : 'D') | translate }}\"></span> <span icon=\"{{ data.Draft ? 'link' : data.Published ? 'link' : '' }}\" tooltip-append-to-body=\"true\" tooltip=\"{{ (data.Draft ? 'Content.Publish.HD' :'') | translate:'{ id: data.Draft.RepositoryId}' }}\n{{ (data.Published ? 'Content.Publish.HP' :'') | translate }} #{{ data.Published.RepositoryId }}\"></span> <span ng-if=\"data.Metadata\" tooltip-append-to-body=\"true\" tooltip=\"Metadata for type {{ data.Metadata.TargetType}}, id {{ data.Metadata.KeyNumber }}{{ data.Metadata.KeyString }}{{ data.Metadata.KeyGuid }}\" icon=\"tag\"></span>",valueGetter:y},{headerName:"Title",field:"Title",width:216,cellClass:"clickable",template:"<span tooltip-append-to-body=\"true\" tooltip=\"{{data.Title}}\" ng-bind=\"data.Title + ' ' + ((!data.Title ? 'Content.Manage.NoTitle':'') | translate)\"></span>",filter:"text",onCellClicked:v},{headerName:"",width:70,suppressSorting:!0,suppressMenu:!0,template:'<button type="button" class="btn btn-xs btn-square" ng-click="vm.openDuplicate(data)" tooltip-append-to-body="true" tooltip="{{ \'General.Buttons.Copy\' | translate }}"><i icon="duplicate"></i></button> <button type="button" class="btn btn-xs btn-square" ng-click="vm.tryToDelete(data, false)" tooltip-append-to-body="true" tooltip="{{ \'General.Buttons.Delete\' | translate }}"><i icon="remove"></i> </button>'}];p()}t.$inject=["contentItemsSvc","eavConfig","appId","contentType","eavAdminDialogs","toastr","debugState","$modalInstance","$q","$modalStack","$translate"],angular.module("ContentItemsAppAgnostic",["EavConfiguration","EavAdminUi","EavServices"]).controller("ContentItemsList",t)}(),function(){function t(t,e,n,a,i,r,o){var l=this;l.debug=r;var s=t(n,a);l.maxDynamicColumns=10,l.add=function(){i.openItemNew(a,s.liveListReload)},l.edit=function(t){i.openItemEditWithEntityId(t.Id,s.liveListReload)},l.refresh=s.liveListReload,l.items=s.liveList(),l.dynamicColumns=[],s.getColumns().then(function(t){for(var e=t.data,n=0;n<e.length&&n<l.maxDynamicColumns;n++)e[n].IsTitle||l.dynamicColumns.push(e[n])}),l.tryToDelete=function(t){confirm("Delete 'title-unknown-yet' ("+t.RepositoryId+") ?")&&s["delete"](t.RepositoryId)},l.openDuplicate=function(t){var e=[{ContentTypeName:a,DuplicateEntity:t.Id}];i.openEditItems(e,s.liveListReload)},l.close=function(){o.dismiss("cancel")}}t.$inject=["contentItemsSvc","eavConfig","appId","contentType","eavAdminDialogs","debugState","$modalInstance"],angular.module("ContentItemsApp",["EavConfiguration","EavAdminUi","EavServices"]).controller("ContentItemsList",t)}(),function(){function t(t,e,n,a,i){var r=this,o=n(t,e);r.entityId=e,r.items=o.liveList(),r.close=function(){a.dismiss("cancel")},r.details=function(t){i.open({animation:!0,templateUrl:"content-items/history-details.html",controller:"HistoryDetails",controllerAs:"vm",resolve:{changeId:function(){return t.ChangeId},dataSvc:function(){return o}}})}}function e(t,e,n){var a=this;alert("not implemented yet");var i=e;i.getVersionDetails(t).then(function(t){alert(t.data),a.items=t.data}),a.close=function(){n.dismiss("cancel")}}t.$inject=["appId","entityId","historySvc","$modalInstance","$modal"],e.$inject=["changeId","dataSvc","$modalInstance"],angular.module("HistoryApp",["EavServices","EavConfiguration","eavTemplates"]).controller("History",t).controller("HistoryDetails",e)}(),function(){angular.module("ContentTypesApp",["EavServices","EavAdminUi","EavDirectives"]).constant("license",{createdBy:"2sic internet solutions",license:"MIT"})}(),function(){function t(t,e,n,a,i,r){var o=this,l=n(t);o.debug=a,o.item=e,o.item.ChangeStaticName=!1,o.item.NewStaticName=o.item.StaticName,o.ok=function(){l.save(e).then(function(){r.close(o.item)})},o.close=function(){r.dismiss("cancel")}}t.$inject=["appId","item","contentTypeSvc","debugState","$translate","$modalInstance"],angular.module("ContentTypesApp").controller("Edit",t)}(),function(){function t(t,e,n,a,i){var r=this;r.items=[n],r.types=e.types.liveList(),r.allInputTypes=e.getInputTypesList(),r.resetSubTypes=function(t){t.InputType=t.Type.toLowerCase()+"-default"},r.ok=function(){e.updateInputType(r.items[0]),i.close()},r.close=function(){i.dismiss("cancel")}}t.$inject=["appId","svc","item","$filter","$modalInstance"],angular.module("ContentTypesApp").controller("FieldEdit",t)}(),function(){function t(t,e,n,a){var i=this,r=e.newItem;i.items=[r(),r(),r(),r(),r(),r(),r(),r(),r(),r()],i.item=e.newItem(),i.types=e.types.liveList(),i.allInputTypes=e.getInputTypesList(),i.resetSubTypes=function(t){t.InputType=t.Type.toLowerCase()+"-default"},i.ok=function(){for(var t=i.items,n=[],r=0;r<t.length;r++)t[r].StaticName&&n.push(t[r]);e.addMany(n,0),a.close()},i.close=function(){a.dismiss("cancel")}}t.$inject=["appId","svc","$filter","$modalInstance"],angular.module("ContentTypesApp").controller("FieldsAdd",t)}(),function(){function t(t,e,n,a,i,r,o,l,s){var d=this,c=e(t,n);d.close=function(){a.dismiss("cancel")},d.items=c.liveList(),d.add=function(){i.open({animation:!0,templateUrl:"content-types/content-types-fields-add.html",controller:"FieldsAdd",controllerAs:"vm",size:"lg",resolve:{svc:function(){return c}}})},d.edit=function(t){i.open({animation:!0,templateUrl:"content-types/content-types-field-edit.html",controller:"FieldEdit",controllerAs:"vm",size:"lg",resolve:{svc:function(){return c},item:function(){return t}}})},d.inputTypeTooltip=function(t){return"unknown"!==t?t:"unknown means it's using an old definition for input-types - edit it to use the new definition"},d.moveUp=c.moveUp,d.moveDown=c.moveDown,d.setTitle=c.setTitle,d.tryToDelete=function(t){return t.IsTitle?l(["General.Messages.CantDelete","General.Terms.Title"],{target:"{0}"}).then(function(t){alert(t["General.Messages.CantDelete"].replace("{0}",t["General.Terms.Title"]))}):l("General.Questions.Delete",{target:"'"+t.StaticName+"' ("+t.Id+")"}).then(function(e){confirm(e)&&c["delete"](t)})},d.rename=function(t){l("General.Questions.Rename",{target:"'"+t.StaticName+"' ("+t.Id+")"}).then(function(e){var n=prompt(e);n&&c.rename(t,n)})},d.createOrEditMetadata=function(t,e){var n=[d.createItemDefinition(t,"All"),d.createItemDefinition(t,e),d.createItemDefinition(t,t.InputType)];r.openEditItems(n,c.liveListReload)},d.createItemDefinition=function(t,e){var n="All"===e?l.instant("DataType.All.Title"):e;return void 0!==t.Metadata[e]?{EntityId:t.Metadata[e].Id,Title:n}:{ContentTypeName:"@"+e,Metadata:{Key:t.Id,KeyType:"number",TargetType:s.metadataOfAttribute},Title:n,Prefill:{Name:t.StaticName}}}}t.$inject=["appId","contentTypeFieldSvc","contentType","$modalInstance","$modal","eavAdminDialogs","$filter","$translate","eavConfig"],angular.module("ContentTypesApp").controller("FieldList",t)}(),function(){function contentTypeListController(contentTypeSvc,eavAdminDialogs,appId,debugState,$translate){var vm=this,svc=contentTypeSvc(appId);vm.debug=debugState,vm.items=svc.liveList(),vm.refresh=svc.liveListReload,vm.tryToDelete=function(t){$translate("General.Questions.Delete",{target:"'"+t.Name+"' ("+t.Id+")"}).then(function(e){confirm(e)&&svc["delete"](t)})},vm.edit=function(t){void 0===t&&(t=svc.newItem()),eavAdminDialogs.openContentTypeEdit(t,vm.refresh)},vm.createGhost=function(){var t=window.prompt("to create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost");t&&svc.createGhost(t)},vm.editFields=function(t){eavAdminDialogs.openContentTypeFields(t,vm.refresh)},vm.editItems=function(t){eavAdminDialogs.openContentItems(svc.appId,t.StaticName,t.Id,vm.refresh)},vm.addItem=function(t){eavAdminDialogs.openItemNew(t,vm.refresh)},vm.liveEval=function admin(){$translate("General.Questions.SystemInput").then(function(msg){var inp=prompt(msg);inp&&eval(inp)})},vm.changeScope=function(){$translate("ContentTypes.Buttons.ChangeScopeQuestion").then(function(t){var e=prompt(t);e&&svc.setScope(e)})},vm.isGuid=function(t){var e=new RegExp(/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/i);return e.test(t)},vm.permissions=function(t){return eavAdminDialogs.openPermissionsForGuid(svc.appId,t.StaticName,vm.refresh)},vm.openExport=function(t){return eavAdminDialogs.openContentExport(svc.appId,t.StaticName,vm.refresh)},vm.openImport=function(t){return eavAdminDialogs.openContentImport(svc.appId,t.StaticName,vm.refresh)}}contentTypeListController.$inject=["contentTypeSvc","eavAdminDialogs","appId","debugState","$translate"],angular.module("ContentTypesApp").controller("List",contentTypeListController)}(),function(){angular.module("EavDirectives",[]).directive("icon",function(){return{restrict:"A",replace:!1,transclude:!1,link:function(t,e,n){var a=n.icon;e.addClass("glyphicon glyphicon-"+a)}}}).directive("stopEvent",function(){return{restrict:"A",link:function(t,e,n){n&&n.stopEvent&&e.bind(n.stopEvent,function(t){t.stopPropagation()})}}}).directive("showDebugAvailability",function(){return{restrict:"E",template:'<span class="low-priority" tooltip="{{ \'AdvancedMode.Info.Available\' | translate }}">&pi;</span><br/>'}})}(),function(){function t(t,e,n,a,i,r){var o=this,l=t(a,i);o.edit=function(t){e.openItemEditWithEntityId(t.Id,l.liveListReload)},o.add=function(){e.openMetadataNew(a,"entity",l.PermissionTargetGuid,l.ctName,l.liveListReload)},o.items=l.liveList(),o.refresh=l.liveListReload,o.tryToDelete=function(t){confirm("Delete '"+t.Title+"' ("+t.Id+") ?")&&l["delete"](t.Id)},o.close=function(){r.dismiss("cancel")}}t.$inject=["permissionsSvc","eavAdminDialogs","eavConfig","appId","targetGuid","$modalInstance"],angular.module("PermissionsApp",["EavServices","EavConfiguration","EavAdminUi"]).controller("PermissionList",t)}(),angular.module("PipelineDesigner",["PipelineDesigner.filters","ngResource","EavConfiguration","EavServices","eavTemplates","eavNgSvcs","EavAdminUi","eavEditEntity"]).directive("datasource",["$timeout",function(t){return{restrict:"A",link:function(e,n){t(function(){e.makeDataSource(e.dataSource,n)}),e.$last===!0&&t(function(){e.$emit("ngRepeatFinished")})}}}]),angular.module("PipelineDesigner.filters",[]).filter("typename",function(){return function(t,e){var n=t.match(/[^,\s]+/g);switch(e){case"classFullName":if(n)return n[0];break;case"className":if(n){var a=n[0].match(/[^\.]+/g);return a[a.length-1]}}return t}}),function(){function t(t){var e=document.documentElement,n=t.getBoundingClientRect(),a=n.top+window.pageYOffset-e.clientTop,i=n.left+window.pageXOffset-e.clientLeft;return{top:a,left:i}}angular.module("PipelineDesigner").controller("PipelineDesignerController",["appId","pipelineId","$scope","pipelineService","$location","debugState","$timeout","ctrlS","$filter","toastrWithHttpErrorHandling","eavAdminDialogs","$log","eavConfig","$q",function(e,n,a,i,r,o,l,s,d,c,p,u,m,v){"use strict";function g(){f.saveShortcut=s(function(){f.savePipeline()})}var f=this;f.debug=o;var b=c,y=b.info("This shouldn't take long","Please wait...");g(),a.readOnly=!0,a.dataSourcesCount=0,a.dataSourceIdPrefix="dataSource_",a.debug=!1,a.PipelineEntityId=n,i.setAppId(e),a.findDataSourceOfElement=function(t){var e=t.attributes.guid.value,n=a.pipelineData.DataSources,i=d("filter")(n,{EntityGuid:e})[0];return i},i.getPipeline(a.PipelineEntityId).then(function(t){a.pipelineData=t,a.PipelineEntityId&&1!==a.pipelineData.DataSources.length?(a.readOnly=!t.Pipeline.AllowEdit,b.clear(y),b.info(a.readOnly?"This pipeline is read only":"You can now design the Pipeline. \nNote that there are still a few UI bugs.\nVisit 2sxc.org/help for more.","Ready",{autoDismiss:!0})):(a.readOnly=!1,C())},function(t){b.error(t,"Loading Pipeline failed")}),jsPlumb.ready(function(){a.jsPlumbInstance=jsPlumb.getInstance({Connector:["Bezier",{curviness:70}],HoverPaintStyle:{lineWidth:4,strokeStyle:"#216477",outlineWidth:2,outlineColor:"white"},PaintStyle:{lineWidth:4,strokeStyle:"#61B7CF",joinstyle:"round",outlineColor:"white",outlineWidth:2},Container:"pipelineContainer"}),a.jsPlumbInstance.bind("connectionDetached",function(t){if(t.targetId===a.dataSourceIdPrefix+"Out"){var e=angular.element(t.target),n=a.findDataSourceOfElement(e).dataSource.Definition().In,i=t.targetEndpoint.getOverlay("endpointLabel").label;-1===n.indexOf(i)&&l(function(){a.jsPlumbInstance.deleteEndpoint(t.targetEndpoint)})}}),a.jsPlumbInstance.bind("connection",function(t){if(a.connectionsInitialized)for(var e=0,n=function(e){var n=e.getOverlay("endpointLabel").getLabel();n===o&&t.targetEndpoint.id!==e.id&&angular.element(e.canvas).hasClass("targetEndpoint")&&(s=e)};;){e++;var i="Please name the Stream";e>1&&(i+=". Ensure the name is not used by any other Stream on this DataSource.");var r=t.targetEndpoint.getOverlay("endpointLabel"),o=prompt(i,r.getLabel());if(o){r.setLabel(o);var l=a.jsPlumbInstance.getEndpoints(t.target.id),s=null;if(angular.forEach(l,n),!s)break}}})});var h=function(t){return[["Label",{id:"endpointLabel",location:[.5,t?-.5:1.5],label:"Default",cssClass:t?"endpointSourceLabel":"endpointTargetLabel",events:{dblclick:function(t){if(!a.readOnly){var e=prompt("Rename Stream",t.label);e&&t.setLabel(e)}}}}]]},I={paintStyle:{fillStyle:"transparent",radius:10,lineWidth:0},cssClass:"sourceEndpoint",maxConnections:-1,isSource:!0,anchor:["Continuous",{faces:["top"]}],overlays:h(!0)},T={paintStyle:{fillStyle:"transparent",radius:10,lineWidth:0},cssClass:"targetEndpoint",maxConnections:1,isTarget:!0,anchor:["Continuous",{faces:["bottom"]}],overlays:h(!1),dropOptions:{hoverClass:"hover",activeClass:"active"}};a.makeDataSource=function(t,e){a.jsPlumbInstance.batch(function(){a.readOnly||a.jsPlumbInstance.draggable(e,{grid:[20,20],drag:a.dataSourceDrag});var n=t.Definition();if(null!==n){if(angular.forEach(n.Out,function(t){S(e,t,!1)}),angular.forEach(n.In,function(t){S(e,t,!0)}),n.In){var i=T;i.maxConnections=-1,a.jsPlumbInstance.makeTarget(e,i)}a.jsPlumbInstance.makeSource(e,I,{filter:".ep .glyphicon"})}}),a.dataSourcesCount++};var S=function(t,e,n){if(!t.length)return void u.error({message:"Element not found",selector:t.selector});console.log(t);var i=a.findDataSourceOfElement(t[0]),r=t[0].id+(n?"_in_":"_out_")+e,o={uuid:r,enabled:!i.ReadOnly||"Out"==i.EntityGuid},l=a.jsPlumbInstance.addEndpoint(t,n?T:I,o);l.getOverlay("endpointLabel").setLabel(e)};a.connectionsInitialized=!1,a.$on("ngRepeatFinished",function(){a.connectionsInitialized||(a.jsPlumbInstance.batch(function(){E(a.pipelineData.Pipeline.StreamWiring)}),a.repaint(),a.connectionsInitialized=!0)});var E=function(t){angular.forEach(t,function(t){var e=a.dataSourceIdPrefix+t.From,n=e+"_out_"+t.Out,i=a.dataSourceIdPrefix+t.To,r=i+"_in_"+t.In;a.jsPlumbInstance.getEndpoint(n)||S(jsPlumb.getSelector("#"+e),t.Out,!1),a.jsPlumbInstance.getEndpoint(r)||S(jsPlumb.getSelector("#"+i),t.In,!0);try{a.jsPlumbInstance.connect({uuids:[n,r]})}catch(o){u.error({message:"Connection failed",from:n,to:r})}})},C=function(){var t=m.pipelineDesigner.defaultPipeline.dataSources;angular.forEach(t,function(t){a.addDataSource(t.partAssemblyAndType,t.visualDesignerData,!1,t.entityGuid)});var e=a.$on("ngRepeatFinished",function(){a.connectionsInitialized=!1,E(m.pipelineDesigner.defaultPipeline.streamWiring),a.connectionsInitialized=!0,e()})};a.addDataSource=function(t,e,n,r){t||(t=a.addDataSourceType.PartAssemblyAndType,a.addDataSourceType=null),e||(e={Top:100,Left:100});var o={VisualDesignerData:e,Name:d("typename")(t,"className"),Description:"",PartAssemblyAndType:t,EntityGuid:r||"unsaved"+(a.dataSourcesCount+1)};o=angular.extend(o,i.getNewDataSource(a.pipelineData,o)),a.pipelineData.DataSources.push(o),n!==!1&&a.savePipeline()},a.remove=function(t){var e=a.pipelineData.DataSources[t];if(confirm('Delete DataSource "'+(e.Name||"(unnamed)")+'"?')){var n=a.dataSourceIdPrefix+e.EntityGuid;a.jsPlumbInstance.selectEndpoints({element:n}).remove(),a.pipelineData.DataSources.splice(t,1)}},a.editName=function(t){if(!t.ReadOnly){var e=prompt("Rename DataSource",t.Name);e&&e.trim()&&(t.Name=e.trim())}},a.editDescription=function(t){if(!t.ReadOnly){var e=prompt("Edit Description",t.Description);e&&e.trim()&&(t.Description=e.trim())}},a.dataSourceDrag=function(e){var n=t(e.el),i=a.findDataSourceOfElement(e.el);a.$apply(function(){i.VisualDesignerData.Top=Math.round(n.top),i.VisualDesignerData.Left=Math.round(n.left)})},a.configureDataSource=function(t){return t.ReadOnly?void 0:D(t)?void i.editDataSourcePart(t):void a.savePipeline()};var D=function(t){return-1===t.EntityGuid.indexOf("unsaved")};a.showEndpointOverlays=!0,a.toggleEndpointOverlays=function(){a.showEndpointOverlays=!a.showEndpointOverlays;var t=a.jsPlumbInstance.selectEndpoints();a.showEndpointOverlays?t.showOverlays():t.hideOverlays()},a.editPipelineEntity=function(){a.savePipeline().then(function(){f.saveShortcut.unbind(),p.openEditItems([{EntityId:a.PipelineEntityId}],function(){i.getPipeline(a.PipelineEntityId).then(P).then(f.saveShortcut.rebind)})})};var w=function(){var t=[];angular.forEach(a.jsPlumbInstance.getAllConnections(),function(e){t.push({From:e.sourceId.substr(a.dataSourceIdPrefix.length),Out:e.endpoints[0].getOverlay("endpointLabel").label,To:e.targetId.substr(a.dataSourceIdPrefix.length),In:e.endpoints[1].getOverlay("endpointLabel").label})}),a.pipelineData.Pipeline.StreamWiring=t;var e=[];a.jsPlumbInstance.selectEndpoints({target:a.dataSourceIdPrefix+"Out"}).each(function(t){e.push(t.getOverlay("endpointLabel").label)}),a.pipelineData.Pipeline.StreamsOut=e.join(",")};f.savePipeline=a.savePipeline=function(t){b.info("This shouldn't take long","Saving...");a.readOnly=!0,w();var e=v.defer();return"undefined"==typeof t&&(t=P),i.savePipeline(a.pipelineData.Pipeline,a.pipelineData.DataSources).then(t,function(t){b.error(t,"Save Pipeline failed"),a.readOnly=!1,e.reject()}).then(function(){e.resolve()}),e.promise};var P=function(t){a.pipelineData.Pipeline=t.Pipeline,a.PipelineEntityId=t.Pipeline.EntityId,r.search("PipelineId",t.Pipeline.EntityId),a.readOnly=!t.Pipeline.AllowEdit,a.pipelineData.DataSources=t.DataSources,i.postProcessDataSources(a.pipelineData),b.clear(),b.success("Pipeline "+t.Pipeline.EntityId+" saved and loaded","Saved",{autoDismiss:!0}),a.jsPlumbInstance.reset(),a.connectionsInitialized=!1};a.repaint=function(){a.jsPlumbInstance.repaintEverything()},a.toogleDebug=function(){a.debug=!a.debug},a.queryPipeline=function(){var t=function(){b.info("Running Query ..."),i.queryPipeline(a.PipelineEntityId).then(function(t){b.clear();var n=p.CreateResolve({testParams:a.pipelineData.Pipeline.TestParameters,result:t});p.OpenModal("pipelines/query-stats.html","QueryStats as vm","lg",n),l(function(){e(t)}),u.debug(t)},function(t){b.error(t,"Query failed")})},e=function(t){angular.forEach(t.Streams,function(t){var e=a.dataSourceIdPrefix+t.Source,n=a.dataSourceIdPrefix+t.Target;"00000000-0000-0000-0000-000000000000"===t.Target&&(n=a.dataSourceIdPrefix+"Out");var i=e+"_out_"+t.SourceOut,r=n+"_in_"+t.TargetIn,o=a.jsPlumbInstance.getEndpoint(i),l=!1;o&&angular.forEach(o.connections,function(e){return e.endpoints[1].getUuid()===r?(e.setLabel({label:t.Count.toString(),cssClass:"streamEntitiesCount"}),void(l=!0)):void 0}),l||u.error("Stream not found",t,o)})};a.savePipeline().then(t)},a.clonePipeline=function(){if(confirm("Clone Pipeline "+a.PipelineEntityId+"?")){var t=function(){return i.clonePipeline(a.PipelineEntityId)},e=function(t){return i.getPipeline(t.EntityId)};a.savePipeline(null).then(t).then(e).then(P)}}}])}(),angular.module("PipelineManagement",["EavServices","EavConfiguration","eavNgSvcs","EavAdminUi"]).controller("PipelineManagement",["$modalInstance","appId","pipelineService","debugState","eavAdminDialogs","eavConfig",function($modalInstance,appId,pipelineService,debugState,eavAdminDialogs,eavConfig){var vm=this;vm.debug=debugState,vm.appId=appId,pipelineService.setAppId(appId),vm.refresh=function(){vm.pipelines=pipelineService.getPipelines(appId)},vm.refresh(),vm["delete"]=function(t){confirm('Delete Pipeline "'+t.Name+'" ('+t.Id+")?")&&pipelineService.deletePipeline(t.Id).then(function(){vm.refresh()},function(t){alert(t)})},vm.clone=function(t){pipelineService.clonePipeline(t.Id).then(function(){vm.refresh()},function(t){alert(t)})},vm.permissions=function(t){return eavAdminDialogs.openPermissionsForGuid(appId,t.Guid)},vm.add=function(){var t=[{ContentTypeName:"DataPipeline",Prefill:{TestParameters:eavConfig.pipelineDesigner.testParameters}}];eavAdminDialogs.openEditItems(t,vm.refresh)},vm.edit=function(t){eavAdminDialogs.openItemEditWithEntityId(t.Id,vm.refresh)},vm.design=function(t){return eavAdminDialogs.editPipeline(vm.appId,t.Id,vm.refresh)},vm.liveEval=function admin(){var inp=prompt("This is for very advanced operations. Only use this if you know what you're doing. \n\n Enter admin commands:");inp&&eval(inp)},vm.close=function(){$modalInstance.dismiss("cancel")}}]),function(){angular.module("PipelineDesigner").controller("QueryStats",["testParams","result","$modalInstance",function(t,e,n){var a=this,i=e;a.testParameters=t.split("\n"),a.timeUsed=i.QueryTimer.Milliseconds,a.ticksUsed=i.QueryTimer.Ticks,
a.result=i.Query,a.sources=i.Sources,a.streams=i.Streams,a.connections="todo",a.close=function(){n.dismiss("cancel")}}])}(),angular.module("EavServices",["ng","EavConfiguration","pascalprecht.translate","ngResource","ngAnimate","toastr"]),angular.module("EavServices").factory("contentItemsSvc",["$http","entitiesSvc","metadataSvc","svcCreator",function(t,e,n,a){return function(n,i){var r={};return r.contentType=i,r.appId=n,r=angular.extend(r,a.implementLiveList(function(){return t.get("eav/entities/GetAllOfTypeForAdmin",{params:{appId:r.appId,contentType:r.contentType}})})),r["delete"]=function(t,n){return e["delete"](r.contentType,t,n)},r.getColumns=function(){return t.get("eav/contenttype/getfields/",{params:{appid:r.appId,staticName:r.contentType}})},r}}]),angular.module("EavServices").factory("contentTypeSvc",["$http","eavConfig","svcCreator",function(t,e,n){return function(a,i){var r={};return r.scope=i||e.contentType.defaultScope,r.appId=a,r.retrieveContentTypes=function(){return t.get("eav/contenttype/get/",{params:{appid:r.appId,scope:r.scope}})},r=angular.extend(r,n.implementLiveList(r.retrieveContentTypes)),r.getDetails=function(e){return t.get("eav/contenttype/GetSingle",{params:{appid:r.appId,contentTypeStaticName:e}})},r.newItem=function(){return{StaticName:"",Name:"",Description:"",Scope:e.contentType.defaultScope}},r.save=function(e){return t.post("eav/contenttype/save/",e,{params:{appid:r.appId}}).then(r.liveListReload)},r["delete"]=function(e){return t.get("eav/contenttype/delete",{params:{appid:r.appId,staticName:e.StaticName}}).then(r.liveListReload)},r.setScope=function(t){r.scope=t,r.liveListReload()},r.createGhost=function(e){return t.get("eav/contenttype/createghost",{params:{appid:r.appId,sourceStaticName:e}}).then(r.liveListReload)},r}}]),angular.module("EavServices").factory("contentTypeFieldSvc",["$http","eavConfig","svcCreator","$filter",function(t,e,n,a){return function(e,i){var r={};return r.appId=e,r.contentType=i,r.typeListRetrieve=function(){return t.get("eav/contenttype/datatypes/",{params:{appid:r.appId}})},r._inputTypesList=[],r.getInputTypesList=function(){return r._inputTypesList.length>0?r._inputTypesList:(t.get("eav/contenttype/inputtypes/",{params:{appid:r.appId}}).then(function(t){function e(t,e){var n={dataType:t.Type.substring(0,t.Type.indexOf("-")),inputType:t.Type,label:t.Label,description:t.Description};r._inputTypesList.push(n)}angular.forEach(t.data,e),r._inputTypesList=a("orderBy")(r._inputTypesList,["dataType","inputType"])}),r._inputTypesList)},r.getFields=function(){return t.get("eav/contenttype/getfields",{params:{appid:r.appId,staticName:r.contentType.StaticName}}).then(function(t){if(t.data)for(var e=0;e<t.data.length;e++){var n=t.data[e];if(n.Metadata){var a=n.Metadata,i=a.All,r=a[n.Type],o=a[n.InputType];a.merged=angular.merge({},i,r,o)}}return t})},r=angular.extend(r,n.implementLiveList(r.getFields)),r.types=n.implementLiveList(r.typeListRetrieve),r.moveUp=function(e){return t.get("eav/contenttype/reorder",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:e.Id,direction:"up"}}).then(r.liveListReload)},r.moveDown=function(e){return t.get("eav/contenttype/reorder",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:e.Id,direction:"down"}}).then(r.liveListReload)},r["delete"]=function(e){return t.get("eav/contenttype/delete",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:e.Id}}).then(r.liveListReload)},r.addMany=function(e,n){return t.get("eav/contenttype/addfield/",{params:e[n]}).then(function(){e.length==++n?r.liveListReload():r.addMany(e,n)})},r.add=function(e){return t.get("eav/contenttype/addfield/",{params:e}).then(r.liveListReload)},r.newItemCount=0,r.newItem=function(){return{AppId:r.appId,ContentTypeId:r.contentType.Id,Id:0,Type:"String",InputType:"string-default",StaticName:"",IsTitle:0===r.liveList().length,SortOrder:r.liveList().length+r.newItemCount++}},r["delete"]=function(e){if(e.IsTitle)throw"Can't delete Title";return t.get("eav/contenttype/deletefield",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:e.Id}}).then(r.liveListReload)},r.updateInputType=function(e){return t.get("eav/contenttype/updateinputtype",{params:{appid:r.appId,attributeId:e.Id,field:e.StaticName,inputType:e.InputType}}).then(r.liveListReload)},r.setTitle=function(e){return t.get("eav/contenttype/setTitle",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:e.Id}}).then(r.liveListReload)},r.rename=function(e,n){return t.get("eav/contenttype/rename",{params:{appid:r.appId,contentTypeId:r.contentType.Id,attributeId:e.Id,newName:n}}).then(r.liveListReload)},r}}]),angular.module("EavServices").factory("ctrlS",["$window",function(t){function e(e){var n={_event:null,_action:null,_isbound:!1,detectCtrlSAndExcecute:function(t){if(83===t.keyCode&&(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)){if(null===n._action)return console.log("can't do anything on ctrl+S, no action registered");t.preventDefault(),n._action()}},bind:function(e){n._action=e,n._isbound=!0,n._event=t.addEventListener("keydown",n.detectCtrlSAndExcecute,!1)},unbind:function(){t.removeEventListener("keydown",n.detectCtrlSAndExcecute),n._isbound=!1},rebind:function(){if(null===n._action)throw"can't rebind, as it was never initially bound";if(!n._isbound)throw"can't rebind, as it's still bound";n.bind(n._action)}};return n.bind(e),n}return e}]),angular.module("EavServices").factory("debugState",["$translate","toastr",function(t,e){var n={on:!1};return n.toggle=function(){n.on=!n.on,e.clear(n.toast),n.toast=e.info(t.instant("AdvancedMode.Info.Turn"+(n.on?"On":"Off")),{timeOut:3e3})},n.autoEnableAsNeeded=function(t){t=window.event||t;var e=navigator.platform.match("Mac")?t.metaKey:t.ctrlKey;e&&!t.alreadySwitchedDebugState&&(n.toggle(),t.alreadySwitchedDebugState=!0)},n}]),angular.module("EavServices").factory("dragClass",function(){return document.addEventListener("dragover",function(){this===document&&document.body.classList.add("eav-dragging")}),document.addEventListener("dragleave",function(){this===document&&document.body.classList.remove("eav-dragging")}),{}}),angular.module("EavAdminUi",["ng","ui.bootstrap","EavServices","eavTemplates","PermissionsApp","ContentItemsAppAgnostic","PipelineManagement","ContentImportApp","ContentExportApp","HistoryApp"]).factory("eavAdminDialogs",["$modal","eavConfig","$window","entitiesSvc","contentTypeSvc","appId",function(t,e,n,a,i,r){var o={};return o.openContentItems=function(t,e,n,a){var i=o.CreateResolve({appId:t,contentType:e,contentTypeId:n});return o.OpenModal("content-items/content-items-agnostic.html","ContentItemsList as vm","fullscreen",i,a)},o.openContentImport=function(t,e,n){var a=o.CreateResolve({appId:t,contentType:e});return o.OpenModal("content-import-export/content-import.html","ContentImport as vm","lg",a,n)},o.openContentExport=function(t,e,n){var a=o.CreateResolve({appId:t,contentType:e});return o.OpenModal("content-import-export/content-export.html","ContentExport as vm","lg",a,n)},o.openContentTypeEdit=function(t,e){var n=o.CreateResolve({item:t});return o.OpenModal("content-types/content-types-edit.html","Edit as vm","",n,e)},o.openContentTypeFields=function(t,e){var n=o.CreateResolve({contentType:t});return o.OpenModal("content-types/content-types-fields.html","FieldList as vm","xlg",n,e)},o.openContentTypeFieldsOfItems=function(t,e){return a.getManyForEditing(r,t).then(function(t){var n=t.data[0].Header.ContentTypeName,a=i(r);return a.getDetails(n).then(function(t){return o.openContentTypeFields(t.data,e)})})},o.openItemNew=function(t,e){return o.openEditItems([{ContentTypeName:t}],e)},o.openItemEditWithEntityId=function(t,e){return o.openEditItems([{EntityId:t}],e)},o.openEditItems=function(t,e){var n=o.CreateResolve({items:t});return o.OpenModal("form/main-form.html","EditEntityWrapperCtrl as vm","ent-edit",n,e)},o.openItemHistory=function(t,e){return o.OpenModal("content-items/history.html","History as vm","lg",o.CreateResolve({entityId:t}),e)},o.openMetadataNew=function(t,n,a,i,r){var l={};switch(n){case"entity":l.Key=a,l.KeyType="guid",l.TargetType=e.metadataOfEntity;break;case"attribute":l.Key=a,l.KeyType="number",l.TargetType=e.metadataOfAttribute;break;default:throw"targetType unknown, only accepts entity or attribute for now"}var s=[{ContentTypeName:i,Metadata:l}];o.openEditItems(s,r)},o.openPermissionsForGuid=function(t,e,n){var a=o.CreateResolve({appId:t,targetGuid:e});return o.OpenModal("permissions/permissions.html","PermissionList as vm","lg",a,n)},o.editPipeline=function(t,e,a){var i=o.derivedUrl({dialog:"pipeline-designer",pipelineId:e});n.open(i)},o.derivedUrl=function(t){var e=window.location.href;for(var n in t)t.hasOwnProperty(n)&&(e=o.replaceOrAddOneParam(e,n,t[n]));return e},o.replaceOrAddOneParam=function(t,e,n){var a=new RegExp("("+e+"=).*?(&)","i"),i=a.test(t)?t.replace(a,"$1"+n+"$2"):t+"&"+e+"="+n;return i},o._attachCallbacks=function(t,e){return"undefined"==typeof e?null:("function"==typeof e&&(e={close:e}),t.result.then(e.success||e.close,e.error||e.close,e.notify||e.close))},o.OpenModal=function(e,n,a,i,r){var l=n.indexOf(" as "),s=l>0?n.substring(l+4):null;l>0&&(n=n.substring(0,l));var d=t.open({animation:!0,templateUrl:e,controller:n,controllerAs:s,size:a,resolve:i});return o._attachCallbacks(d,r)},o.CreateResolve=function(){var t={},e=arguments[0];for(var n in e)e.hasOwnProperty(n)&&(t[n]=o._create1Resolve(e[n]));return t},o._create1Resolve=function(t){return function(){return t}},o}]),angular.module("eavNgSvcs",["ng"]).config(["$locationProvider",function(t){t.html5Mode({enabled:!0,requireBase:!1})}]),angular.module("EavServices").service("fileType",function(){var t={};return t.iconPrefix="icon-",t.defaultIcon="file",t.checkImgRegEx=/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*\.(?:jpg|jpeg|gif|png))(?:\?([^#]*))?(?:#(.*))?/i,t.extensions={doc:"file-word",docx:"file-word",xls:"file-excel",xlsx:"file-excel",ppt:"file-powerpoint",pptx:"file-powerpoint",pdf:"file-pdf",mp3:"file-audio",avi:"file-video",mpg:"file-video",mpeg:"file-video",mov:"file-video",mp4:"file-video",zip:"file-archive",rar:"file-archive",txt:"file-text",html:"file-code",css:"file-code",xml:"file-code",xsl:"file-code",vcf:"user"},t.getExtension=function(t){return t.substr(t.lastIndexOf(".")+1).toLowerCase()},t.getIconClass=function(e){return t.iconPrefix+(t.extensions[t.getExtension(e)]||t.defaultIcon)},t.isKnownType=function(e){return-1!==t.extensions.indexOf[t.getExtension(e)]},t.isImage=function(e){return t.checkImgRegEx.test(e)},t}),angular.module("EavServices").factory("historySvc",["$http","svcCreator",function(t,e){return function(n,a){var i={appId:n,entityId:a};return i=angular.extend(i,e.implementLiveList(function(){return t.get("eav/entities/history",{params:{appId:i.appId,entityId:i.entityId}}).then(function(t){for(var e=t.data,n=0;n<e.length;n++)e[n].VirtualVersion=e.length-n;return t})})),i.getVersionDetails=function(e){return t.get("eav/entities/historydetails",{params:{appId:i.appId,entityId:i.entityId,changeId:e}})},i}}]),function(){angular.module("EavServices").config(["$translateProvider","languages","$translatePartialLoaderProvider",function(t,e,n){t.preferredLanguage(e.currentLanguage.split("-")[0]).useSanitizeValueStrategy("escapeParameters").fallbackLanguage(e.fallbackLanguage).useLoader("$translatePartialLoader",{urlTemplate:e.i18nRoot+"{part}-{lang}.js"}).useLoaderCache(!0),n.addPart("admin").addPart("edit")}]).run(["$rootScope","$translate",function(t,e){t.$on("$translatePartialLoaderStructureChanged",function(){e.refresh()})}])}(),function(){function t(t){return window.$2sxc?window.$2sxc.urlParams.get(t):e(t)}function e(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)","i"),n=e.exec(location.search);if(null===n){var a=new RegExp("[#&]"+t+"=([^&#]*)","i");n=a.exec(location.hash)}if(null===n){var i=window.location.pathname.match(new RegExp("/"+t+"/([^/]+)","i"));null!==i&&i.length>1&&(n=i.reverse()[0])}else n=n[1];return null===n?"":decodeURIComponent(n.replace(/\+/g," "))}angular.module("InitParametersFromUrl",[]).factory("appId",function(){return t("appId")}).factory("zoneId",function(){return t("zoneId")}).factory("entityId",function(){return t("entityid")}).factory("contentTypeName",function(){return t("contenttypename")}).factory("pipelineId",function(){return t("pipelineId")}).factory("dialog",function(){return t("dialog")}).factory("$modalInstance",function(){return null})}(),angular.module("EavServices").factory("latinizeText",function(){return function(t){var e={"Á":"A","Ă":"A","Ắ":"A","Ặ":"A","Ằ":"A","Ẳ":"A","Ẵ":"A","Ǎ":"A","Â":"A","Ấ":"A","Ậ":"A","Ầ":"A","Ẩ":"A","Ẫ":"A","Ä":"Ae","Ǟ":"A","Ȧ":"A","Ǡ":"A","Ạ":"A","Ȁ":"A","À":"A","Ả":"A","Ȃ":"A","Ā":"A","Ą":"A","Å":"A","Ǻ":"A","Ḁ":"A","Ⱥ":"A","Ã":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ḃ":"B","Ḅ":"B","Ɓ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ć":"C","Č":"C","Ç":"C","Ḉ":"C","Ĉ":"C","Ċ":"C","Ƈ":"C","Ȼ":"C","Ď":"D","Ḑ":"D","Ḓ":"D","Ḋ":"D","Ḍ":"D","Ɗ":"D","Ḏ":"D","ǲ":"D","ǅ":"D","Đ":"D","Ƌ":"D","Ǳ":"DZ","Ǆ":"DZ","É":"E","Ĕ":"E","Ě":"E","Ȩ":"E","Ḝ":"E","Ê":"E","Ế":"E","Ệ":"E","Ề":"E","Ể":"E","Ễ":"E","Ḙ":"E","Ë":"E","Ė":"E","Ẹ":"E","Ȅ":"E","È":"E","Ẻ":"E","Ȇ":"E","Ē":"E","Ḗ":"E","Ḕ":"E","Ę":"E","Ɇ":"E","Ẽ":"E","Ḛ":"E","Ꝫ":"ET","Ḟ":"F","Ƒ":"F","Ǵ":"G","Ğ":"G","Ǧ":"G","Ģ":"G","Ĝ":"G","Ġ":"G","Ɠ":"G","Ḡ":"G","Ǥ":"G","Ḫ":"H","Ȟ":"H","Ḩ":"H","Ĥ":"H","Ⱨ":"H","Ḧ":"H","Ḣ":"H","Ḥ":"H","Ħ":"H","Í":"I","Ĭ":"I","Ǐ":"I","Î":"I","Ï":"I","Ḯ":"I","İ":"I","Ị":"I","Ȉ":"I","Ì":"I","Ỉ":"I","Ȋ":"I","Ī":"I","Į":"I","Ɨ":"I","Ĩ":"I","Ḭ":"I","Ꝺ":"D","Ꝼ":"F","Ᵹ":"G","Ꞃ":"R","Ꞅ":"S","Ꞇ":"T","Ꝭ":"IS","Ĵ":"J","Ɉ":"J","Ḱ":"K","Ǩ":"K","Ķ":"K","Ⱪ":"K","Ꝃ":"K","Ḳ":"K","Ƙ":"K","Ḵ":"K","Ꝁ":"K","Ꝅ":"K","Ĺ":"L","Ƚ":"L","Ľ":"L","Ļ":"L","Ḽ":"L","Ḷ":"L","Ḹ":"L","Ⱡ":"L","Ꝉ":"L","Ḻ":"L","Ŀ":"L","Ɫ":"L","ǈ":"L","Ł":"L","Ǉ":"LJ","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ń":"N","Ň":"N","Ņ":"N","Ṋ":"N","Ṅ":"N","Ṇ":"N","Ǹ":"N","Ɲ":"N","Ṉ":"N","Ƞ":"N","ǋ":"N","Ñ":"N","Ǌ":"NJ","Ó":"O","Ŏ":"O","Ǒ":"O","Ô":"O","Ố":"O","Ộ":"O","Ồ":"O","Ổ":"O","Ỗ":"O","Öe":"O","Ȫ":"O","Ȯ":"O","Ȱ":"O","Ọ":"O","Ő":"O","Ȍ":"O","Ò":"O","Ỏ":"O","Ơ":"O","Ớ":"O","Ợ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ȏ":"O","Ꝋ":"O","Ꝍ":"O","Ō":"O","Ṓ":"O","Ṑ":"O","Ɵ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Õ":"O","Ṍ":"O","Ṏ":"O","Ȭ":"O","Ƣ":"OI","Ꝏ":"OO","Ɛ":"E","Ɔ":"O","Ȣ":"OU","Ṕ":"P","Ṗ":"P","Ꝓ":"P","Ƥ":"P","Ꝕ":"P","Ᵽ":"P","Ꝑ":"P","Ꝙ":"Q","Ꝗ":"Q","Ŕ":"R","Ř":"R","Ŗ":"R","Ṙ":"R","Ṛ":"R","Ṝ":"R","Ȑ":"R","Ȓ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꜿ":"C","Ǝ":"E","Ś":"S","Ṥ":"S","Š":"S","Ṧ":"S","Ş":"S","Ŝ":"S","Ș":"S","Ṡ":"S","Ṣ":"S","Ṩ":"S","Ť":"T","Ţ":"T","Ṱ":"T","Ț":"T","Ⱦ":"T","Ṫ":"T","Ṭ":"T","Ƭ":"T","Ṯ":"T","Ʈ":"T","Ŧ":"T","Ɐ":"A","Ꞁ":"L","Ɯ":"M","Ʌ":"V","Ꜩ":"TZ","Ú":"U","Ŭ":"U","Ǔ":"U","Û":"U","Ṷ":"U","Ü":"Ue","Ǘ":"U","Ǚ":"U","Ǜ":"U","Ǖ":"U","Ṳ":"U","Ụ":"U","Ű":"U","Ȕ":"U","Ù":"U","Ủ":"U","Ư":"U","Ứ":"U","Ự":"U","Ừ":"U","Ử":"U","Ữ":"U","Ȗ":"U","Ū":"U","Ṻ":"U","Ų":"U","Ů":"U","Ũ":"U","Ṹ":"U","Ṵ":"U","Ꝟ":"V","Ṿ":"V","Ʋ":"V","Ṽ":"V","Ꝡ":"VY","Ẃ":"W","Ŵ":"W","Ẅ":"W","Ẇ":"W","Ẉ":"W","Ẁ":"W","Ⱳ":"W","Ẍ":"X","Ẋ":"X","Ý":"Y","Ŷ":"Y","Ÿ":"Y","Ẏ":"Y","Ỵ":"Y","Ỳ":"Y","Ƴ":"Y","Ỷ":"Y","Ỿ":"Y","Ȳ":"Y","Ɏ":"Y","Ỹ":"Y","Ź":"Z","Ž":"Z","Ẑ":"Z","Ⱬ":"Z","Ż":"Z","Ẓ":"Z","Ȥ":"Z","Ẕ":"Z","Ƶ":"Z","Ĳ":"IJ","Œ":"OE","ᴀ":"A","ᴁ":"AE","ʙ":"B","ᴃ":"B","ᴄ":"C","ᴅ":"D","ᴇ":"E","ꜰ":"F","ɢ":"G","ʛ":"G","ʜ":"H","ɪ":"I","ʁ":"R","ᴊ":"J","ᴋ":"K","ʟ":"L","ᴌ":"L","ᴍ":"M","ɴ":"N","ᴏ":"O","ɶ":"OE","ᴐ":"O","ᴕ":"OU","ᴘ":"P","ʀ":"R","ᴎ":"N","ᴙ":"R","ꜱ":"S","ᴛ":"T","ⱻ":"E","ᴚ":"R","ᴜ":"U","ᴠ":"V","ᴡ":"W","ʏ":"Y","ᴢ":"Z","á":"a","ă":"a","ắ":"a","ặ":"a","ằ":"a","ẳ":"a","ẵ":"a","ǎ":"a","â":"a","ấ":"a","ậ":"a","ầ":"a","ẩ":"a","ẫ":"a","ä":"ae","ǟ":"a","ȧ":"a","ǡ":"a","ạ":"a","ȁ":"a","à":"a","ả":"a","ȃ":"a","ā":"a","ą":"a","ᶏ":"a","ẚ":"a","å":"a","ǻ":"a","ḁ":"a","ⱥ":"a","ã":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ḃ":"b","ḅ":"b","ɓ":"b","ḇ":"b","ᵬ":"b","ᶀ":"b","ƀ":"b","ƃ":"b","ɵ":"o","ć":"c","č":"c","ç":"c","ḉ":"c","ĉ":"c","ɕ":"c","ċ":"c","ƈ":"c","ȼ":"c","ď":"d","ḑ":"d","ḓ":"d","ȡ":"d","ḋ":"d","ḍ":"d","ɗ":"d","ᶑ":"d","ḏ":"d","ᵭ":"d","ᶁ":"d","đ":"d","ɖ":"d","ƌ":"d","ı":"i","ȷ":"j","ɟ":"j","ʄ":"j","ǳ":"dz","ǆ":"dz","é":"e","ĕ":"e","ě":"e","ȩ":"e","ḝ":"e","ê":"e","ế":"e","ệ":"e","ề":"e","ể":"e","ễ":"e","ḙ":"e","ë":"e","ė":"e","ẹ":"e","ȅ":"e","è":"e","ẻ":"e","ȇ":"e","ē":"e","ḗ":"e","ḕ":"e","ⱸ":"e","ę":"e","ᶒ":"e","ɇ":"e","ẽ":"e","ḛ":"e","ꝫ":"et","ḟ":"f","ƒ":"f","ᵮ":"f","ᶂ":"f","ǵ":"g","ğ":"g","ǧ":"g","ģ":"g","ĝ":"g","ġ":"g","ɠ":"g","ḡ":"g","ᶃ":"g","ǥ":"g","ḫ":"h","ȟ":"h","ḩ":"h","ĥ":"h","ⱨ":"h","ḧ":"h","ḣ":"h","ḥ":"h","ɦ":"h","ẖ":"h","ħ":"h","ƕ":"hv","í":"i","ĭ":"i","ǐ":"i","î":"i","ï":"i","ḯ":"i","ị":"i","ȉ":"i","ì":"i","ỉ":"i","ȋ":"i","ī":"i","į":"i","ᶖ":"i","ɨ":"i","ĩ":"i","ḭ":"i","ꝺ":"d","ꝼ":"f","ᵹ":"g","ꞃ":"r","ꞅ":"s","ꞇ":"t","ꝭ":"is","ǰ":"j","ĵ":"j","ʝ":"j","ɉ":"j","ḱ":"k","ǩ":"k","ķ":"k","ⱪ":"k","ꝃ":"k","ḳ":"k","ƙ":"k","ḵ":"k","ᶄ":"k","ꝁ":"k","ꝅ":"k","ĺ":"l","ƚ":"l","ɬ":"l","ľ":"l","ļ":"l","ḽ":"l","ȴ":"l","ḷ":"l","ḹ":"l","ⱡ":"l","ꝉ":"l","ḻ":"l","ŀ":"l","ɫ":"l","ᶅ":"l","ɭ":"l","ł":"l","ǉ":"lj","ſ":"s","ẜ":"s","ẛ":"s","ẝ":"s","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ᵯ":"m","ᶆ":"m","ń":"n","ň":"n","ņ":"n","ṋ":"n","ȵ":"n","ṅ":"n","ṇ":"n","ǹ":"n","ɲ":"n","ṉ":"n","ƞ":"n","ᵰ":"n","ᶇ":"n","ɳ":"n","ñ":"n","ǌ":"nj","ó":"o","ŏ":"o","ǒ":"o","ô":"o","ố":"o","ộ":"o","ồ":"o","ổ":"o","ỗ":"o","ö":"oe","ȫ":"o","ȯ":"o","ȱ":"o","ọ":"o","ő":"o","ȍ":"o","ò":"o","ỏ":"o","ơ":"o","ớ":"o","ợ":"o","ờ":"o","ở":"o","ỡ":"o","ȏ":"o","ꝋ":"o","ꝍ":"o","ⱺ":"o","ō":"o","ṓ":"o","ṑ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","õ":"o","ṍ":"o","ṏ":"o","ȭ":"o","ƣ":"oi","ꝏ":"oo","ɛ":"e","ᶓ":"e","ɔ":"o","ᶗ":"o","ȣ":"ou","ṕ":"p","ṗ":"p","ꝓ":"p","ƥ":"p","ᵱ":"p","ᶈ":"p","ꝕ":"p","ᵽ":"p","ꝑ":"p","ꝙ":"q","ʠ":"q","ɋ":"q","ꝗ":"q","ŕ":"r","ř":"r","ŗ":"r","ṙ":"r","ṛ":"r","ṝ":"r","ȑ":"r","ɾ":"r","ᵳ":"r","ȓ":"r","ṟ":"r","ɼ":"r","ᵲ":"r","ᶉ":"r","ɍ":"r","ɽ":"r","ↄ":"c","ꜿ":"c","ɘ":"e","ɿ":"r","ß":"ss","ś":"s","ṥ":"s","š":"s","ṧ":"s","ş":"s","ŝ":"s","ș":"s","ṡ":"s","ṣ":"s","ṩ":"s","ʂ":"s","ᵴ":"s","ᶊ":"s","ȿ":"s","ɡ":"g","ᴑ":"o","ᴓ":"o","ᴝ":"u","ť":"t","ţ":"t","ṱ":"t","ț":"t","ȶ":"t","ẗ":"t","ⱦ":"t","ṫ":"t","ṭ":"t","ƭ":"t","ṯ":"t","ᵵ":"t","ƫ":"t","ʈ":"t","ŧ":"t","ᵺ":"th","ɐ":"a","ᴂ":"ae","ǝ":"e","ᵷ":"g","ɥ":"h","ʮ":"h","ʯ":"h","ᴉ":"i","ʞ":"k","ꞁ":"l","ɯ":"m","ɰ":"m","ᴔ":"oe","ɹ":"r","ɻ":"r","ɺ":"r","ⱹ":"r","ʇ":"t","ʌ":"v","ʍ":"w","ʎ":"y","ꜩ":"tz","ú":"u","ŭ":"u","ǔ":"u","û":"u","ṷ":"u","ü":"ue","ǘ":"u","ǚ":"u","ǜ":"u","ǖ":"u","ṳ":"u","ụ":"u","ű":"u","ȕ":"u","ù":"u","ủ":"u","ư":"u","ứ":"u","ự":"u","ừ":"u","ử":"u","ữ":"u","ȗ":"u","ū":"u","ṻ":"u","ų":"u","ᶙ":"u","ů":"u","ũ":"u","ṹ":"u","ṵ":"u","ᵫ":"ue","ꝸ":"um","ⱴ":"v","ꝟ":"v","ṿ":"v","ʋ":"v","ᶌ":"v","ⱱ":"v","ṽ":"v","ꝡ":"vy","ẃ":"w","ŵ":"w","ẅ":"w","ẇ":"w","ẉ":"w","ẁ":"w","ⱳ":"w","ẘ":"w","ẍ":"x","ẋ":"x","ᶍ":"x","ý":"y","ŷ":"y","ÿ":"y","ẏ":"y","ỵ":"y","ỳ":"y","ƴ":"y","ỷ":"y","ỿ":"y","ȳ":"y","ẙ":"y","ɏ":"y","ỹ":"y","ź":"z","ž":"z","ẑ":"z","ʑ":"z","ⱬ":"z","ż":"z","ẓ":"z","ȥ":"z","ẕ":"z","ᵶ":"z","ᶎ":"z","ʐ":"z","ƶ":"z","ɀ":"z","ﬀ":"ff","ﬃ":"ffi","ﬄ":"ffl","ﬁ":"fi","ﬂ":"fl","ĳ":"ij","œ":"oe","ﬆ":"st","ₐ":"a","ₑ":"e","ᵢ":"i","ⱼ":"j","ₒ":"o","ᵣ":"r","ᵤ":"u","ᵥ":"v","ₓ":"x"};return t.replace(/[^A-Za-z0-9\[\] ]/g,function(t){return e[t]||t})}}),angular.module("EavServices").factory("metadataSvc",["$http","appId",function(t,e){var n={};return n.getMetadata=function(n,a,i){return t.get("eav/metadata/getassignedentities",{params:{appId:e,assignmentObjectTypeId:n,keyType:"guid",key:a,contentType:i}})},n}]),angular.module("EavServices").factory("permissionsSvc",["$http","eavConfig","entitiesSvc","metadataSvc","svcCreator","contentTypeSvc",function(t,e,n,a,i,r){var o=e;return function(t,e){var l={PermissionTargetGuid:e,ctName:"PermissionConfiguration",ctId:0,EntityAssignment:o.metadataOfEntity,ctSvc:r(t)};return l=angular.extend(l,i.implementLiveList(function(){return a.getMetadata(l.EntityAssignment,l.PermissionTargetGuid,l.ctName).then(l.updateLiveAll)})),l.ctSvc.getDetails(l.ctName).then(function(t){l.ctId=t.data.Id}),l["delete"]=function(t){return n["delete"](l.ctName,t).then(l.liveListReload)},l}}]),angular.module("EavServices").factory("pipelineService",["$resource","$q","$filter","eavConfig","$http","contentTypeSvc","metadataSvc","eavAdminDialogs",function(t,e,n,a,i,r,o,l){"use strict";var s={};s.pipelineResource=t("eav/PipelineDesigner/:action"),s.entitiesResource=t("eav/Entities/:action"),s.appId=0,s.getDataSourceDefinitionProperty=function(t,e){var a=n("filter")(t.InstalledDataSources,function(t){return t.PartAssemblyAndType==e.PartAssemblyAndType})[0];if(!a)throw"DataSource Definition not found: "+e.PartAssemblyAndType;return a};var d=function(t){t.DataSources.push({Name:a.pipelineDesigner.outDataSource.name,Description:a.pipelineDesigner.outDataSource.description,EntityGuid:"Out",PartAssemblyAndType:a.pipelineDesigner.outDataSource.className,VisualDesignerData:a.pipelineDesigner.outDataSource.visualDesignerData,ReadOnly:!0}),angular.forEach(t.DataSources,function(e){e.Definition=function(){return s.getDataSourceDefinitionProperty(t,e)},e.ReadOnly=e.ReadOnly||!t.Pipeline.AllowEdit})};return angular.extend(s,{getPipeline:function(t){var n=e.defer(),i=s.pipelineResource.get({action:"GetPipeline",id:t,appId:s.appId}),r=s.pipelineResource.query({action:"GetInstalledDataSources"});return e.all([i.$promise,r.$promise]).then(function(e){var i=JSON.parse(angular.toJson(e[0]));i.InstalledDataSources=JSON.parse(angular.toJson(e[1])),t||(i.Pipeline={AllowEdit:"True"}),i.InstalledDataSources.push({PartAssemblyAndType:a.pipelineDesigner.outDataSource.className,ClassName:a.pipelineDesigner.outDataSource.className,In:a.pipelineDesigner.outDataSource["in"],Out:null,allowNew:!1}),d(i),n.resolve(i)},function(t){n.reject(t)}),n.promise},postProcessDataSources:function(t){n("filter")(t.DataSources,function(t){return"Out"==t.EntityGuid})[0]||d(t)},getNewDataSource:function(t,e){return{Definition:function(){return s.getDataSourceDefinitionProperty(t,e)}}},savePipeline:function(t,n){if(!s.appId)return e.reject("appId must be set to save a Pipeline");var a=[];return angular.forEach(n,function(t){var e=angular.copy(t);delete e.ReadOnly,a.push(e)}),s.pipelineResource.save({action:"SavePipeline",appId:s.appId,Id:t.EntityId},{pipeline:t,dataSources:a}).$promise},clonePipeline:function(t){return s.pipelineResource.get({action:"ClonePipeline",appId:s.appId,Id:t}).$promise},editDataSourcePart:function(t){var e=n("typename")(t.PartAssemblyAndType,"classFullName"),a="|Config "+e,i=4,r=t.EntityGuid;o.getMetadata(i,r,a).then(function(t){var e=t.data;if(e.length)l.openItemEditWithEntityId(e[0].Id);else{var n=[{ContentTypeName:a,Metadata:{TargetType:i,KeyType:"guid",Key:r}}];l.openEditItems(n)}})}}),angular.extend(s,{queryPipeline:function(t){return s.pipelineResource.get({action:"QueryPipeline",appId:s.appId,id:t}).$promise},setAppId:function(t){s.appId=t},getPipelines:function(){return s.entitiesResource.query({action:"GetEntities",appId:s.appId,contentType:"DataPipeline"})},deletePipeline:function(t){return s.pipelineResource.get({action:"DeletePipeline",appId:s.appId,id:t}).$promise}}),s}]),angular.module("EavServices").factory("svcCreator",["toastr","$translate","$timeout",function(t,e,n){var a={};return a.implementLiveList=function(a,i){var r={};return r.disableToastr=!!i,r.liveListCache=[],r.liveListCache.isLoaded=!1,r.liveList=function(){return 0===r.liveListCache.length&&r.liveListReload(),r.liveListCache},r._liveListUpdateWithResult=function(e){r.msg.isOpened?t.clear(r.msg):n(300).then(function(){t.clear(r.msg)}),r.liveListCache.length=0;for(var a=0;a<e.data.length;a++)r.liveListCache.push(e.data[a]);return r.liveListCache.isLoaded=!0,e},r.liveListSourceRead=a,r.liveListReload=function(){return e("General.Messages.Loading").then(function(e){r.msg=t.info(e)}),r.liveListSourceRead().then(r._liveListUpdateWithResult)},r.liveListReset=function(){r.liveListCache=[]},r},a}]),angular.module("EavServices").config(["toastrConfig",function(t){angular.extend(t,{autoDismiss:!1,containerId:"toast-container",maxOpened:5,newestOnTop:!0,positionClass:"toast-top-right",preventDuplicates:!1,preventOpenDuplicates:!1,target:"body"})}]).factory("toastrWithHttpErrorHandling",["toastr",function(t){return t.originalError=t.error,t.error=function(e,n,a){var i;e&&e.data&&e.data.Message?(i=e.data.Message,e.data.ExceptionMessage&&(i+="\n"+e.data.ExceptionMessage)):i=e,t.originalError(i,n,a)},t}]).factory("saveToastr",["toastr","$translate",function(t,e){function n(n){var a=t.info(e.instant("Message.Saving"));return n.then(function(n){return t.clear(a),t.success(e.instant("Message.Saved"),{timeOut:3e3}),n},function(n){return t.clear(a),t.error(e.instant("Message.ErrorWhileSaving")),n})}return n}]).factory("promiseToastr",["toastrWithHttpErrorHandling","$translate",function(t,e){function n(n,a,i,r,o,l,s){var d=t,c=d.info(e.instant(a));return n.then(function(t){return d.clear(c),d.success(e.instant(i),{timeOut:l||1e3}),t},function(t){return d.clear(c),d.error(t,e.instant(r)),t})}return n}]),angular.module("eavTemplates",[]).run(["$templateCache",function(t){t.put("content-import-export/content-export.html",'\r\n<div class="modal-header">\r\n    <button class="btn btn-default btn-square btn-subtle pull-right" type="button" icon="remove" ng-click="vm.close()"></button>\r\n    <h3 class="modal-title" translate="Content.Export.Title">cc</h3>\r\n</div>\r\n\r\n<div class="modal-body">\r\n    <div translate="Content.Export.Help"></div>\r\n    <formly-form form="vm.form" model="vm.formValues" fields="vm.formFields">\r\n    </formly-form>\r\n</div>\r\n\r\n<div class="modal-footer">\r\n    <button type="button" class="btn btn-primary pull-left" ng-click="vm.exportContent()" translate="Content.Export.Commands.Export"></button>\r\n</div>'),t.put("content-import-export/content-import.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <!-- HEADER -->\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" icon="remove" ng-click="vm.close()"></button>\r\n        <h3 class="modal-title"><span  translate="Content.Import.Title"></span> <span ng-show="vm.viewStateSelected > 0" translate="Content.Import.TitleSteps" translate-values="{step: vm.viewStateSelected}"></span></h3>\r\n    </div>\r\n    <!-- END HEADER -->\r\n\r\n    <div ng-switch="vm.viewStateSelected">\r\n\r\n        <!-- FORM -->\r\n        <div ng-switch-when="1">\r\n            <div class="modal-body">\r\n                <div translate="Content.Import.Help"></div>\r\n                <formly-form form="vm.form" model="vm.formValues" fields="vm.formFields"></formly-form>\r\n                <div class="text-warning" translate="Content.Import.Messages.BackupContentBefore"></div>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-primary pull-left" ng-click="vm.evaluateContent()" ng-disabled="!vm.formValues.File || !vm.formValues.File.filename" translate="Content.Import.Commands.Preview"></button>\r\n            </div>\r\n        </div>\r\n        <!-- END FORM -->\r\n\r\n\r\n        <!-- WAITING -->\r\n        <div ng-switch-when="0">\r\n            <div class="modal-body"> {{\'Content.Import.Messages.WaitingForResponse\' | translate}}\r\n            </div>\r\n        </div>\r\n        <!-- END WAITING -->\r\n\r\n\r\n        <!-- EVALUATION RESULT -->\r\n        <div ng-switch-when="2">\r\n            <div class="modal-body">\r\n                <!-- DETAILS / STATISTICS -->\r\n                <div ng-if="vm.evaluationResult.Succeeded">\r\n                    <h4 translate="Content.Import.Evaluation.Detail.Title" translate-values="{filename: vm.formValues.File.filename}"></h4>\r\n                    <h5 translate="Content.Import.Evaluation.Detail.File.Title"></h5>\r\n                    <ul>\r\n                        <li translate="Content.Import.Evaluation.Detail.File.ElementCount" translate-values="{count: vm.evaluationResult.Detail.DocumentElementsCount}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.File.LanguageCount" translate-values="{count: vm.evaluationResult.Detail.LanguagesInDocumentCount}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.File.Attributes" translate-values="{count: vm.evaluationResult.Detail.AttributeNamesInDocument.length, attributes: vm.evaluationResult.Detail.AttributeNamesInDocument.join(\', \')}"></li>\r\n                    </ul>\r\n                    <h5 translate="Content.Import.Evaluation.Detail.Entities.Title"></h5>\r\n                    <ul>\r\n                        <li translate="Content.Import.Evaluation.Detail.Entities.Create" translate-values="{count: vm.evaluationResult.Detail.AmountOfEntitiesCreated}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.Entities.Update" translate-values="{count: vm.evaluationResult.Detail.AmountOfEntitiesUpdated}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.Entities.Delete" translate-values="{count: vm.evaluationResult.Detail.AmountOfEntitiesDeleted}"></li>\r\n                        <li translate="Content.Import.Evaluation.Detail.Entities.AttributesIgnored" translate-values="{count: vm.evaluationResult.Detail.AttributeNamesNotImported.length, attributes: vm.evaluationResult.Detail.AttributeNamesNotImported.join(\', \')}"></li>\r\n                    </ul>\r\n                    <div class="text-warning" translate="Content.Import.Messages.ImportCanTakeSomeTime"></div>\r\n                </div>\r\n                <!-- END DETAILS / STATISTICS -->\r\n                <!-- ERRORS -->\r\n                <div ng-if="!vm.evaluationResult.Succeeded">\r\n                    <h4 translate="Content.Import.Evaluation.Error.Title" translate-values="{filename: vm.formValues.File.filename}"></h4>\r\n                    <ul>\r\n                        <li ng-repeat="error in vm.evaluationResult.Detail">\r\n                            <div><span translate="Content.Import.Evaluation.Error.Codes.{{error.ErrorCode}}"></span></div>\r\n                            <div ng-if="error.ErrorDetail"><i translate="Content.Import.Evaluation.Error.Detail" translate-values="{detail: error.ErrorDetail}"></i>\r\n                            </div>\r\n                            <div ng-if="error.LineNumber"><i translate=Content.Import.Evaluation.Error.LineNumber" translate-values="{number: error.LineNumber}"></i>\r\n                            </div>\r\n                            <div ng-if="error.LineDetail"><i translate="Content.Import.Evaluation.Error.LineDetail" translate-values="{detail: error.LineDetail}"></i>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <!-- END ERRORS -->\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn pull-left" ng-click="vm.back()" icon="arrow-left"></button>\r\n                <button type="button" class="btn btn-default pull-left" ng-click="vm.importContent()" translate="Content.Import.Commands.Import" ng-disabled="!vm.evaluationResult.Succeeded"></button>\r\n            </div>\r\n        </div>\r\n        <!-- END EVALUATION RESULT -->\r\n\r\n\r\n        <!-- IMPORT RESULT -->\r\n        <div ng-switch-when="3">\r\n            <div class="modal-body">\r\n                <span ng-show="vm.importResult.Succeeded" translate="Content.Import.Messages.ImportSucceeded"></span>\r\n                <span ng-hide="vm.importResult.Succeeded" translate="Content.Import.Messages.ImportFailed"></span>\r\n            </div>\r\n        </div>\r\n        <!-- END IMPORT RESULT -->\r\n\r\n        <div ng-if="vm.debug.on">\r\n            <h3>Debug infos</h3>\r\n            <pre>{{vm.formValues | json}}</pre>\r\n        </div>\r\n    </div>\r\n</div>'),
t.put("content-items/content-edit.html",'<div class="modal-header">\r\n    <button type="button" class="btn btn-default btn-subtle" ng-click="vm.history()">\r\n        <span class="glyphicon glyphicon-time"> history / todo </span>\r\n    </button>\r\n    <h3 class="modal-title">Edit / New Content</h3>\r\n</div>\r\n\r\n<div class="modal-body">\r\n    this is where the edit appears. Would edit entity {{vm.entityId}} or add a {{vm.contentType}} - depending on the mode: {{vm.mode}}\r\n    <h3>Use cases</h3>\r\n    <ol>\r\n        <li>Edit an existing entity with ID</li>\r\n        <li>Create a new entity of a certaint content-type, just save and done (like from a "new" button without content-group)</li>\r\n        <li>Create a new entity of a certain type and assign it to a metadata thing (guid, int, string)</li>\r\n\r\n        <li>Create a new entity and put it into a content-group at the right place</li>\r\n        <li>Edit content-group: item + presentation </li>\r\n        <li>Edit multiple IDs/or new/mix: Edit multiple items with IDs</li>\r\n    </ol>\r\n\r\n    init of 1 edit\r\n    - entity-id in storage\r\n    - new-type + optional: assignment-id + assignment-type\r\n\r\n    - array of the above\r\n    --- [{id 17}, {type: "person"}, {type: person, asstype: 4, target: 0205}]\r\n\r\n    - content-group\r\n</div>\r\n'),t.put("content-items/content-items-agnostic.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)" class="content-items-agnostic">\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="Content.Manage.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <button type="button" class="btn btn-primary btn-square" ng-click="vm.add()"><i icon="plus"></i></button>\r\n	    <button ng-if="vm.debug.on" type="button" class="btn btn-warning btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n\r\n		<div ag-grid="vm.gridOptions" class="ag-grid-wrapper"></div>\r\n	    \r\n        <show-debug-availability class="pull-right" ></show-debug-availability>\r\n    </div>\r\n</div>'),t.put("content-items/content-items.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="Content.Manage.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <button type="button" class="btn btn-primary btn-square" ng-click="vm.add()"><i icon="plus"></i></button>\r\n        <button ng-if="vm.debug.on" type="button" class="btn btn-warning btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n\r\n        <div style="overflow: auto">\r\n            <table class="table table-hover table-manage-eav">\r\n                <thead>\r\n                <tr>\r\n                    <th translate="Content.Manage.Table.Id" class="col-id"></th>\r\n                    <th translate="Content.Manage.Table.Status" style="width: 60px"></th>\r\n                    <th translate="Content.Manage.Table.Title" style="width: 200px"></th>\r\n                    <th translate="Content.Manage.Table.Actions" class="mini-btn-2"></th>\r\n                    <th ng-repeat="col in vm.dynamicColumns" style="width: 10%">{{col.StaticName}}</th>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                <tr ng-repeat="item in vm.items | orderBy: [\'Id\',\'-IsPublished\'] " class="clickable-row" ng-click="vm.edit(item)">\r\n                    <td class="text-nowrap clickable" style="text-align: right">\r\n                        <span tooltip="Id: {{item.Id}}\r\nRepoId: {{item.RepositoryId}}\r\nGuid: {{item.Guid}}">{{item.Id}}</span>\r\n                    </td>\r\n                    <td class="text-nowrap">\r\n                        <span class="glyphicon" ng-class="{\'glyphicon-eye-open\': item.IsPublished, \'glyphicon-eye-close\' : !item.IsPublished}" tooltip="{{ \'Content.Publish.\' + (item.IsPublished ? \'PnV\': item.Published ? \'DoP\' : \'D\') | translate }}"></span>\r\n                        <span icon="{{ item.Draft ? \'link\' : item.Published ? \'link\' : \'\' }}" tooltip="{{ (item.Draft ? \'Content.Publish.HD\' :\'\') | translate:\'{ id: item.Draft.RepositoryId}\' }}\r\n{{ (item.Published ? \'Content.Publish.HP\' :\'\') | translate }} #{{ item.Published.RepositoryId }}"></span>\r\n                        <span ng-if="item.Metadata" tooltip="Metadata for type {{ item.Metadata.TargetType}}, id {{ item.Metadata.KeyNumber }}{{ item.Metadata.KeyString }}{{ item.Metadata.KeyGuid }}" icon="tag"></span>\r\n                    </td>\r\n                    <td class="text-nowrap clickable">\r\n                        <div class="hide-overflow-text" style="height: 20px; width: 200px" tooltip="{{item.Title}}">\r\n                            {{item.Title}}{{ (!item.Title ? \'Content.Manage.NoTitle\':\'\') | translate }}\r\n                        </div>\r\n                    </td>\r\n                    <td class="text-nowrap" stop-event="click">\r\n                        <button type="button" class="btn btn-xs btn-square" ng-click="vm.openDuplicate(item)" tooltip="{{ \'General.Buttons.Copy\' | translate }}"><i icon="duplicate"></i></button>\r\n                        <button type="button" class="btn btn-xs btn-square" ng-click="vm.tryToDelete(item)" tooltip="{{ \'General.Buttons.Delete\' | translate }}"><i icon="remove"></i> </button>\r\n                    </td>\r\n                    <td ng-repeat="col in vm.dynamicColumns" width="10%">\r\n                        <div style="height: 20px; max-width: 300px;" class="hide-overflow-text" tooltip="{{item[col.StaticName]}}">{{item[col.StaticName].toString().substring(0,25)}}</div>\r\n                    </td>\r\n\r\n                </tr>\r\n                <tr ng-if="!vm.items.length">\r\n                    <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <show-debug-availability class="pull-right" ></show-debug-availability>\r\n    </div>\r\n</div>'),t.put("content-items/history-details.html",'<div>\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-subtle btn-square pull-right" type="button" ng-click="vm.close()">\r\n            <span class="glyphicon glyphicon-remove"></span>\r\n        </button>\r\n        <h3 class="modal-title">History Details {{vm.ChangeId}} of {{vm.entityId}}</h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <h1>todo</h1>\r\n        <table class="table table-striped table-hover">\r\n            <thead>\r\n            <tr>\r\n                <th>Field</th>\r\n                <th>Language</th>\r\n                <th>Value</th>\r\n                <th>SharedWith</th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr ng-repeat="item in vm.items | orderBy:SysCreatedDate:reverse">\r\n                <td>{{item.Field}}</td>\r\n                <td>{{item.Language}}</td>\r\n                <td>{{item.Value}}</td>\r\n                <td>{{item.SharedWith}}</td>\r\n\r\n            </tr>\r\n            <tr ng-if="!vm.items.length">\r\n                <td colspan="100">No History</td>\r\n            </tr>\r\n            </tbody>\r\n        </table>\r\n\r\n        <button class="btn btn-primary pull-right" type="button" ng-click="vm.restore()">\r\n            <span class="glyphicon glyphicon-ok">todo restore</span>\r\n        </button>    </div>\r\n\r\n</div>'),t.put("content-items/history.html",'<div>\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()">\r\n            <span class="glyphicon glyphicon-remove"></span>\r\n        </button>\r\n        <h3 class="modal-title">{{ "Content.History.Title" | translate:\'{ id:vm.entityId }\' }}History of {{vm.entityId}}</h3>\r\n    </div>\r\n    <div class="modal-body">\r\n\r\n        <table class="table table-striped table-hover">\r\n            <thead>\r\n            <tr>\r\n                <th translate="Content.History.Table.Id"></th>\r\n                <th translate="Content.History.Table.When"></th>\r\n                <th translate="Content.History.Table.User"></th>\r\n                <th translate="Content.History.Table.Action"></th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr ng-repeat="item in vm.items | orderBy:SysCreatedDate:reverse">\r\n                <td><span tooltip="ChangeId: {{item.ChangeId}}">{{item.VirtualVersion}}</span></td>\r\n                <td>{{item.SysCreatedDate.replace("T", " ")}}</td>\r\n                <td>{{item.User}}</td>\r\n                <td>\r\n                    <button type="button" class="btn btn-xs" ng-click="vm.details(item)">\r\n                        <span class="glyphicon glyphicon-search"></span>\r\n                    </button>\r\n                </td>\r\n            </tr>\r\n                <tr ng-if="!vm.items.length">\r\n                    <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n</div>'),t.put("content-types/content-types-edit.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="ContentTypeEdit.Title"></h3>\r\n    </div>\r\n\r\n    <div class="modal-body">\r\n        {{ "ContentTypeEdit.Name" | translate }}: <br />\r\n        <input ng-model="vm.item.Name" class="input-lg" />\r\n        <br />\r\n        {{ "ContentTypeEdit.Description" | translate }}: <br />\r\n        <input ng-model="vm.item.Description" class="input-lg"/><br/>\r\n\r\n        <div>\r\n            {{ "ContentTypeEdit.Scope" | translate }}: <br />\r\n            <span ng-if="vm.debug.on">\r\n                <div class="alert alert-danger">the scope should almost never be changed - <a href="http://2sxc.org/help?tag=scope" _target="_blank">see help</a></div>\r\n            </span>\r\n            <input ng-disabled="!vm.debug.on" ng-model="vm.item.Scope" class="input-lg" />\r\n        </div>\r\n\r\n        <div ng-if="vm.debug.on" class="alert-danger">\r\n            <h3>Static Name</h3>\r\n            <input type="checkbox" class="input-lg" ng-model="vm.item.ChangeStaticName"/> Really edit StaticName??? - this is usually a very bad idea\r\n            <br/>\r\n            <input ng-model="vm.item.NewStaticName" ng-disabled="!vm.item.ChangeStaticName" class="input-lg"/>\r\n        </div>\r\n        <div ng-if="vm.debug.on" class="alert-danger">\r\n            <h3>Shared Content Type (Ghost)</h3>\r\n            <div>Note: this can\'t be edited in the UI, for now if you really know what you\'re doing, do it in the DB</div>\r\n            <div>Uses Type Definition of: {{vm.item.SharedDefId}}</div> \r\n        </div>\r\n    </div>\r\n    <div class="modal-footer">\r\n        <button class="btn btn-primary btn-square pull-left btn-lg" type="button" ng-click="vm.ok()"><i icon="ok"></i></button>\r\n        <show-debug-availability class="pull-right" style="margin-top: 20px;"></show-debug-availability>\r\n    </div>\r\n</div>'),t.put("content-types/content-types-field-edit.html",'<div class="modal-header">\r\n    <button icon="remove" class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"></button>\r\n    <h3 class="modal-title" translate="Fields.TitleEdit"></h3>\r\n</div>\r\n<div class="modal-body">\r\n    <table class="table table-hover table-manage-eav">\r\n        <thead>\r\n        <tr>\r\n            <th translate="Fields.Table.Name" style="width: 33%"></th>\r\n            <th translate="Fields.Table.DataType" style="width: 33%">Data Type</th>\r\n            <th translate="Fields.Table.InputType" style="width: 33%">Input Type</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr ng-repeat="item in vm.items">\r\n            <td>\r\n                <input ng-model="item.StaticName" ng-required="true" class="input-lg" style="width: 100%" disabled="disabled"/>\r\n            </td>\r\n            <td>\r\n                <input ng-model="item.Type" disabled="disabled" class="input-lg" style="width: 100%"/>\r\n            </td>\r\n            <td>\r\n                <select class="input-lg" ng-model="item.InputType" style="width: 100%"\r\n                        tooltip="{{ (vm.allInputTypes | filter: { inputType: item.InputType})[0].description }}"\r\n                        ng-options="o.inputType as o.label for o in vm.allInputTypes | filter: {dataType: item.Type.toLowerCase() } ">\r\n                </select>\r\n\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n<div class="modal-footer">\r\n    <button icon="ok" class="btn btn-lg btn-primary btn-square pull-left" type="button" ng-click="vm.ok()"></button>\r\n</div>'),t.put("content-types/content-types-fields-add.html",'<div class="modal-header">\r\n    <button icon="remove" class="btn btn-default btn-square btn-subtle pull-right" type="button" ng-click="vm.close()"></button>\r\n    <h3 class="modal-title" translate="Fields.TitleEdit"></h3>\r\n</div>\r\n<div class="modal-body">\r\n    <table class="table table-hover table-manage-eav">\r\n        <thead>\r\n        <tr>\r\n            <th translate="Fields.Table.Name" style="width: 33%"></th>\r\n            <th translate="Fields.Table.DataType" style="width: 33%">Data Type</th>\r\n            <th translate="Fields.Table.InputType" style="width: 33%">Input Type</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr ng-repeat="item in vm.items">\r\n            <td>\r\n                <input ng-model="item.StaticName" ng-required="true" class="input-lg" style="width: 100%"/>\r\n            </td>\r\n            <td>\r\n                <select class="input-lg" ng-model="item.Type" style="width: 100%"\r\n                        tooltip="{{ \'DataType.\' + item.Type + \'.Explanation\' | translate }}"\r\n                        ng-options="o as \'DataType.\' + o + \'.Choice\' | translate for o in vm.types | orderBy: \'toString()\' "\r\n                        ng-change="vm.resetSubTypes(item)">\r\n                    <option>-- select --</option>\r\n                </select>\r\n            </td>\r\n            <td>\r\n                <select class="input-lg" ng-model="item.InputType" style="width: 100%"\r\n                        tooltip="{{ (vm.allInputTypes | filter: { inputType: item.InputType})[0].description }}"\r\n                        ng-options="o.inputType as o.label for o in vm.allInputTypes | filter: {dataType: item.Type.toLowerCase() } ">\r\n                </select>\r\n\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n<div class="modal-footer">\r\n    <button icon="ok" class="btn btn-lg btn-primary btn-square pull-left" type="button" ng-click="vm.ok()"></button>\r\n</div>'),t.put("content-types/content-types-fields.html",'<div>\r\n\r\n    <div class="modal-header">\r\n        <button class="btn btn-default btn-subtle btn-square pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="Fields.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <button icon="plus" ng-click="vm.add()" class="btn btn-primary btn-square"></button>\r\n\r\n        <!-- Table of content types for editing -->\r\n        <table class="table table-hover table-manage-eav">\r\n            <thead>\r\n                <tr>\r\n                    <th translate="Fields.Table.Title" class="mini-btn-1"></th>\r\n                    <th translate="Fields.Table.Name" style="width: 40%"></th>\r\n                    <th translate="Fields.Table.DataType" style="width: 20%"></th>\r\n                    <th translate="Fields.Table.InputType" style="width: 20%"></th>\r\n                    <th translate="Fields.Table.Label" style="width: 30%"></th>\r\n                    <th translate="Fields.Table.Notes" style="width: 50%"></th>\r\n                    <th translate="Fields.Table.Sort" class="mini-btn-2"></th>\r\n                    <th translate="Fields.Table.Action" class="mini-btn-2"></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr ng-repeat="item in vm.items | orderBy: \'SortOrder\'" class="clickable-row" ng-click="vm.createOrEditMetadata(item, item.Type)">\r\n                    <td stop-event="click">\r\n                        <button type="button" class="btn btn-xs btn-square" ng-style="(item.IsTitle ? \'\' : \'color: transparent !important\')" ng-click="vm.setTitle(item)">\r\n                            <i icon="{{item.IsTitle ? \'star\' : \'star-empty\'}}"></i>\r\n                        </button>\r\n                    </td>\r\n                    <td class="clickable"><span tooltip="{{ \'Id: \' + item.Id}}">{{item.StaticName}}</span></td>\r\n                    <td class="text-nowrap clickable">\r\n                        {{item.Type}}\r\n                    </td>\r\n                    <td class="text-nowrap InputType" stop-event="click">\r\n                        <span class="clickable" tooltip="{{ vm.inputTypeTooltip(item.InputType) }}" ng-click="vm.edit(item)">\r\n                            <i icon="pencil"></i>\r\n                            {{item.InputType.substring(item.InputType.indexOf(\'-\') + 1, 100)}}\r\n                        </span>\r\n                    </td>\r\n                    <td class="text-nowrap clickable">\r\n                        {{item.Metadata.All.Name}}\r\n                    </td>\r\n                    <!--<td>-</td>-->\r\n                    <td class="text-nowrap clickable">\r\n                        <div class="hide-overflow-text">\r\n                            {{item.Metadata.All.Notes}}\r\n                        </div>\r\n                    </td>\r\n\r\n                    <td class="text-nowrap" stop-event="click">\r\n                        <button icon="arrow-up" type="button" class="btn btn-xs btn-square" ng-disabled="$first" ng-click="vm.moveUp(item)"></button>\r\n                        <button icon="arrow-down" type="button" class="btn btn-xs btn-square" ng-disabled="$last" ng-click="vm.moveDown(item)"></button>\r\n                    </td>\r\n                    <td stop-event="click">\r\n                        <button icon="cog" type="button" class="btn btn-xs btn-square" ng-click="vm.rename(item)"></button>\r\n                        <button icon="remove" type="button" class="btn btn-xs btn-square" ng-click="vm.tryToDelete(item)"></button>\r\n                    </td>\r\n                </tr>\r\n                <tr ng-if="!vm.items.length">\r\n                    <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n\r\n    </div>\r\n\r\n\r\n</div>'),t.put("content-types/content-types.html",'<div ng-controller="List as vm" ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <div class="modal-header">\r\n        <h3 class="modal-title" translate="ContentTypes.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <!-- Buttons on top -->\r\n        <button title="{{ \'General.Buttons.Add\' | translate }}" type="button" class="btn btn-primary btn-square" ng-click="vm.edit()"><i icon="plus"></i></button>\r\n\r\n\r\n        <span class="btn-group" ng-if="vm.debug.on">\r\n            <button title="{{ \'General.Buttons.Refresh\' | translate }}" type="button" class="btn btn-warning btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n            <button title="todo" type="button" class="btn btn-warning btn-icon" ng-click="vm.createGhost()"><i class="icon-ghost"></i></button>\r\n            <button title="{{ \'ContentTypes.Buttons.ChangeScope\' | translate }}" type="button" class="btn btn-warning btn-square" ng-click="vm.changeScope()"><i icon="record"></i></button>\r\n            <button title="{{ \'General.Buttons.System\' | translate }}" type="button" class="btn btn-warning btn-square" ng-click="vm.liveEval()"><i icon="flash"></i></button>\r\n        </span>\r\n        <!-- Table of content types for editing -->\r\n        <table class="table table-hover" style="table-layout: fixed; width: 100%">\r\n            <thead>\r\n            <tr>\r\n                <!--<th translate="ContentTypes.TypesTable.Items" class="col-id"></th>-->\r\n                <th translate="ContentTypes.TypesTable.Name" style="width: 50%"></th>\r\n                <th class="mini-btn-1"></th>\r\n                <th translate="ContentTypes.TypesTable.Description" style="width: 50%"></th>\r\n                <th translate="ContentTypes.TypesTable.Fields" class="mini-btn-2"></th>\r\n                <th translate="ContentTypes.TypesTable.Actions" class="mini-btn-3"></th>\r\n                <th class="mini-btn-1"> </th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr ng-if="vm.items.isLoaded" ng-repeat="item in vm.items | orderBy:\'Name\'" class="clickable-row" ng-click="vm.editItems(item)">\r\n                <!--<td style="text-align: center" class="clickable"> {{item.Items}} </td>-->\r\n                <td class="clickable">\r\n                    <span class="text-nowrap hide-overflow-text" style="max-width: 400px" tooltip="{{item.Name}}">{{item.Name}}</span>\r\n                </td>\r\n                <td class="clickable" style="text-align: right">\r\n                    <div class="badge pull-right badge-primary hover-pair" stop-event="click" ng-click="vm.addItem(item.StaticName)"><span class="hover-default">{{item.Items}}</span><span class="hover-hover icon-plus"></span></div></td>\r\n                <td class="clickable">\r\n                    <div class="text-nowrap hide-overflow-text" style="max-width: 500px" tooltip="{{item.Description}}">{{item.Description}}</div>\r\n                </td>\r\n                <td stop-event="click">\r\n                    <button ng-if="!item.UsesSharedDef" type="button" class="btn btn-xs" style="width: 60px" ng-click="vm.editFields(item)">\r\n                        <i class="icon-fields"></i>&nbsp;<span style="width: 22px; text-align: right">{{item.Fields}}</span>\r\n                    </button>\r\n                    <button ng-if="item.UsesSharedDef" tooltip="{{ \'ContentTypes.Messages.SharedDefinition\' | translate:item }}" type="button" class="btn btn-default btn-xs" style="width: 60px">\r\n                        <i class="icon-ghost"></i>&nbsp;<span style="width: 22px; text-align: right">{{item.Fields}}</span>\r\n                    </button>\r\n                </td>\r\n\r\n                <td class="text-nowrap" stop-event="click">\r\n                    <span class="btn-group">\r\n                        <button tooltip="{{ \'General.Buttons.Rename\' | translate }} - {{  \'ContentTypes.Messages.Type\' + (item.UsesSharedDef ? \'Shared\' : \'Own\')  | translate:item }}" type="button" class="btn btn-xs btn-square" ng-click="vm.edit(item)">\r\n                            <i icon="heart{{ (item.UsesSharedDef ? \'-empty\' : \'\') }}"></i>\r\n                        </button>\r\n                        <button tooltip="{{ \'ContentTypes.Buttons.Export\' | translate }}" type="button" class="btn btn-xs btn-square" ng-click="vm.openExport(item)"><i icon="export"></i></button>\r\n                        <button tooltip="{{ \'ContentTypes.Buttons.Import\' | translate }}" type="button" class="btn btn-xs btn-square" ng-click="vm.openImport(item)"><i icon="import"></i></button>\r\n                        <button type="button" class="btn btn-xs btn-square" ng-click="vm.permissions(item)" ng-if="vm.isGuid(item.StaticName)"><i icon="user"></i></button>\r\n                    </span>\r\n                </td>\r\n                <td stop-event="click">\r\n                    <button icon="remove" type="button" class="btn btn-xs" ng-click="vm.tryToDelete(item)"></button>\r\n                </td>\r\n            </tr>\r\n            <tr ng-if="!vm.items.length">\r\n                <td colspan="100">{{ \'General.Messages.Loading\' | translate }} / {{ \'General.Messages.NothingFound\' | translate }}</td>\r\n            </tr>\r\n            </tbody>\r\n        </table>\r\n        <show-debug-availability class="pull-right"></show-debug-availability>\r\n    </div>\r\n    <div ng-if="vm.debug.on">\r\n\r\n        <h3>Notes / Debug / ToDo</h3>\r\n        <ol>\r\n            <li>get validators to work on all dialogs</li>\r\n        </ol>\r\n    </div>\r\n</div>\r\n'),t.put("pipelines/pipeline-designer.html",'<div class="ng-cloak">\r\n    <div ng-controller="PipelineDesignerController as vm" ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n        <div id="pipelineContainer">\r\n            <div ng-repeat="dataSource in pipelineData.DataSources"\r\n                 datasource\r\n                 guid="{{dataSource.EntityGuid}}"\r\n                 id="dataSource_{{dataSource.EntityGuid}}"\r\n                 class="dataSource"\r\n                 ng-attr-style="top: {{dataSource.VisualDesignerData.Top}}px; left: {{dataSource.VisualDesignerData.Left}}px">\r\n                <div class="configure" ng-click="configureDataSource(dataSource)" title="Configure this DataSource" ng-if="!dataSource.ReadOnly">\r\n                    <span class="glyphicon glyphicon-list-alt"></span>\r\n                </div>\r\n                <div class="name" title="Click to edit the Name" ng-click="editName(dataSource)">{{dataSource.Name || \'(unnamed)\'}}</div><br />\r\n                <div class="description" title="Click to edit the Description" ng-click="editDescription(dataSource)">{{dataSource.Description || \'(no description)\'}}</div><br />\r\n                <div class="typename" ng-attr-title="{{dataSource.PartAssemblyAndType}}">Type: {{dataSource.PartAssemblyAndType | typename: \'className\'}}</div>\r\n                <div class="ep" title="Drag a new Out-Connection from here" ng-if="!dataSource.ReadOnly">\r\n                    <span class="glyphicon glyphicon-plus-sign"></span>\r\n                </div>\r\n                <div class="delete glyphicon glyphicon-remove" title="Delete this DataSource" ng-click="remove($index)" ng-if="!dataSource.ReadOnly"></div>\r\n            </div>\r\n        </div>\r\n        <div class="actions panel panel-default">\r\n            <div class="panel-heading">\r\n                <span class="pull-left">Actions</span>\r\n                <a href="http://2sxc.org/help" class="btn btn-info btn-xs pull-right" target="_blank"><span class="glyphicon glyphicon-question-sign"></span> Help</a>\r\n            </div>\r\n            <div class="panel-body">\r\n                <button type="button" class="btn btn-primary btn-block" title="Query the Data of this Pipeline" ng-click="queryPipeline()">\r\n                    <span class="glyphicon glyphicon-play"></span> Query\r\n                </button>\r\n\r\n                <select class="form-control" ng-model="addDataSourceType" ng-disabled="readOnly" ng-change="addDataSource()" ng-options="d.ClassName for d in pipelineData.InstalledDataSources | filter: {allowNew: \'!false\'} | orderBy: \'ClassName\'">\r\n                    <option value="">-- Add DataSource --</option>\r\n                </select>\r\n                <!--<button type="button" class="btn btn-default btn-sm" title="Clone this Pipeline with all DataSources and Configurations" ng-click="clonePipeline()" ng-disabled="!PipelineEntityId"><span class="glyphicon glyphicon-share-alt"></span> Clone</button>-->\r\n                <button type="button" class="btn btn-default btn-block" ng-click="editPipelineEntity()"><span class="glyphicon glyphicon-pencil"></span> Test Parameters</button>\r\n                <button type="button" class="btn btn-primary btn-block" ng-disabled="readOnly" ng-click="savePipeline()">\r\n                    <span icon="ok"></span> Save\r\n                </button>\r\n                <br/>\r\n                <br/>\r\n                <button type="button" class="btn btn-info btn-xs" ng-click="toggleEndpointOverlays()"><span class="glyphicon glyphicon-info-sign"></span> {{showEndpointOverlays ? \'Hide\' : \'Show\' }} Overlays</button>\r\n                <button type="button" class="btn btn-info btn-xs" ng-click="repaint()"><span class="glyphicon glyphicon-repeat"></span> Repaint</button>\r\n                <button type="button" class="btn btn-info btn-xs" ng-if="vm.debug.on" ng-click="toogleDebug()"><span class="glyphicon glyphicon-info-sign"></span> {{debug ? \'Hide\' : \'Show\'}} Debug Info</button>\r\n\r\n                <show-debug-availability class="pull-right"></show-debug-availability>\r\n            </div>\r\n        </div>\r\n        <toaster-container></toaster-container>\r\n        <pre ng-if="debug">{{pipelineData | json}}</pre>\r\n    </div>\r\n</div>\r\n'),t.put("pipelines/pipelines.html",'<div ng-click="vm.debug.autoEnableAsNeeded($event)">\r\n    <div class="modal-header">\r\n        <h3 class="modal-title" translate="Pipeline.Manage.Title"></h3>\r\n    </div>\r\n    <div class="modal-body ng-cloak">\r\n        <div translate="Pipeline.Manage.Intro"></div>\r\n        <div>\r\n            <button icon="plus" type="button" class="btn btn-primary btn-square" ng-click="vm.add()"></button>\r\n            <span class="btn-group" ng-if="vm.debug.on">\r\n                <button type="button" class="btn btn-warning btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n                <button type="button" class="btn btn-warning btn-square" ng-click="vm.liveEval()"><i icon="flash"></i></button>\r\n            </span>\r\n            <table class="table table-hover table-manage-eav">\r\n                <thead>\r\n                <tr>\r\n                    <th translate="Pipeline.Manage.Table.Id" class="col-id"></th>\r\n                    <th translate="Pipeline.Manage.Table.Name"></th>\r\n                    <th translate="Pipeline.Manage.Table.Description"></th>\r\n                    <th translate="Pipeline.Manage.Table.Actions" class="mini-btn-4"></th>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                <tr ng-repeat="pipeline in vm.pipelines | orderBy:\'Name\'" class="clickable-row" ng-click="vm.design(pipeline)">\r\n                    <td class="clickable">{{pipeline.Id}}</td>\r\n                    <td class="clickable">{{pipeline.Name}}</td>\r\n                    <td class="clickable">{{pipeline.Description}}</td>\r\n                    <td class="text-nowrap mini-btn-4" stop-event=\'click\'>\r\n                        <span class="btn-group">\r\n                            <button title="{{ \'General.Buttons.Edit\' | translate }}" class="btn btn-xs" ng-click="vm.edit(pipeline)"><i icon="cog"></i></button>\r\n                            <button title="{{ \'General.Buttons.Copy\' | translate }}" type="button" class="btn btn-xs" ng-click="vm.clone(pipeline)"><i icon="duplicate"></i></button>\r\n                            <button title="{{ \'General.Buttons.Permissions\' | translate }}" type="button" class="btn btn-xs" ng-click="vm.permissions(pipeline)"><i icon="user"></i></button>\r\n                        </span>\r\n                        <button title="{{ \'General.Buttons.Delete\' | translate }}" type="button" class="btn btn-xs" ng-click="vm.delete(pipeline)"><i icon="remove"></i></button>\r\n                    </td>\r\n                </tr>\r\n                <tr ng-if="!vm.pipelines.length">\r\n                    <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n\r\n        <show-debug-availability class="pull-right"></show-debug-availability>\r\n    </div>\r\n\r\n</div>'),
t.put("pipelines/query-stats.html",'<div class="modal-header">\r\n    <button icon="remove" class="btn pull-right" type="button" ng-click="vm.close()"></button>\r\n    <h3 class="modal-title" translate="Pipeline.Stats.Title"></h3>\r\n</div>\r\n\r\n<div class="modal-body">\r\n    <div translate="Pipeline.Stats.Intro"></div>\r\n\r\n    <div>\r\n        <h3 translate="Pipeline.Stats.ParamTitle"></h3>\r\n        <div translate="Pipeline.Stats.ExecutedIn" translate-values="{ ms: vm.timeUsed, ticks: vm.ticksUsed }"></div>\r\n        <div>\r\n            <ul>\r\n                <li ng-repeat="param in vm.testParameters">{{param}}</li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    <div>\r\n        <h3 translate="Pipeline.Stats.QueryTitle"></h3>\r\n        <pre>{{vm.result | json}}</pre>\r\n    </div>\r\n    <div>\r\n        <h3 translate="Pipeline.Stats.SourcesAndStreamsTitle"></h3>\r\n        <h4 translate="Pipeline.Stats.Sources.Title"></h4>\r\n        <table>\r\n            <tr>\r\n                <th translate="Pipeline.Stats.Sources.Guid"></th>\r\n                <th translate="Pipeline.Stats.Sources.Type"></th>\r\n                <th translate="Pipeline.Stats.Sources.Config"></th>\r\n            </tr>\r\n            <tr ng-repeat="s in vm.sources">\r\n                <td tooltip="{{s}}"><pre>{{s.Guid.substring(0, 13)}}...</pre></td>\r\n                <td>{{s.Type}}</td>\r\n                <td tooltip="{{s.Configuration}}">\r\n                    <ol>\r\n                        <li ng-repeat="(key, value) in s.Configuration"><b>{{key}}</b>=<em>{{value}}</em></li>\r\n                    </ol>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n\r\n        <h4 translate="Pipeline.Stats.Streams.Title"></h4>\r\n        <table>\r\n            <tr>\r\n                <th translate="Pipeline.Stats.Streams.Source"></th>\r\n                <th translate="Pipeline.Stats.Streams.Target"></th>\r\n                <th translate="Pipeline.Stats.Streams.Items"></th>\r\n                <th translate="Pipeline.Stats.Streams.Error"></th>\r\n            </tr>\r\n            <tr ng-repeat="sr in vm.streams">\r\n                <td><pre>{{sr.Source.substring(0, 13) + ":" + sr.SourceOut}}</pre></td>\r\n                <td><pre>{{sr.Target.substring(0, 13) + ":" + sr.TargetIn}}</pre></td>\r\n                <td><span>{{sr.Count}}</span></td>\r\n                <td><span>{{sr.Error}}</span></td>\r\n            </tr>\r\n        </table>\r\n\r\n    </div>\r\n</div>'),t.put("permissions/permissions.html",'    <div class="modal-header">\r\n        <button class="btn btn-default btn-square pull-right" type="button" ng-click="vm.close()"><i icon="remove"></i></button>\r\n        <h3 class="modal-title" translate="Permissions.Title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n\r\n        <button type="button" class="btn btn-primar btn-square" ng-click="vm.add()"><i icon="plus"></i></button>\r\n        <button ng-if="vm.debug.on" type="button" class="btn btn-square" ng-click="vm.refresh()"><i icon="repeat"></i></button>\r\n\r\n        <table class="table table-striped table-hover table-manage-eav">\r\n            <thead>\r\n            <tr>\r\n                <th translate="Permissions.Table.Id" style="width: 60px"></th>\r\n                <th translate="Permissions.Table.Name" style="width: 33%"></th>\r\n                <th translate="Permissions.Table.Condition" style="width: 33%"></th>\r\n                <th translate="Permissions.Table.Grant" style="width: 33%"></th>\r\n                <th translate="Permissions.Table.Actions" style="width: 40px"></th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr ng-repeat="item in vm.items | orderBy:\'Title\'" class="clickable-row" ng-click="vm.edit(item)">\r\n                <td class="clickable">{{item.Id}}</td>\r\n                <td class="clickable">{{item.Title}}</td>\r\n                <td class="clickable">{{item.Condition}}</td>\r\n                <td class="clickable">{{item.Grant}}</td>\r\n                <td class="text-nowrap" stop-event="click">\r\n                    <button icon="remove" type="button" class="btn btn-xs btn-square" ng-click="vm.tryToDelete(item)"></button>\r\n                </td>\r\n            </tr>\r\n            <tr ng-if="!vm.items.length">\r\n                <td colspan="100" translate="General.Messages.NothingFound"></td>\r\n            </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>')}]);